{"version":3,"sources":["coronita/helpers.listbox.js"],"names":["Coronita","helpers","listbox","listboxOptions","defaults","mainSelector","comboboxSelector","listboxSelector","inputSelector","disabledSelector","type","listboxParams","$","extend","closeCombo","attr","removeClass","options","listOptions","optionId","optionText","optionHtml","each","on","event","which","text","html","parent","prev","trim","find","siblings","removeAttr","labelFloated","target","combo","closest","comboValue","val","length","addClass","childSelected","is","next","children"],"mappings":"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","sourcesContent":["Coronita.helpers.listbox = function (listboxOptions) {\n  var defaults = {\n    mainSelector: '.c-combo-box',\n    comboboxSelector: '.c-combo-box__combobox',\n    listboxSelector: '.c-combo-box__listbox',\n    inputSelector: '.c-combo-box__input',\n    disabledSelector: '[aria-disabled]',\n    type: 'cComboBox'\n  },\n    listboxParams = $.extend({}, defaults, listboxOptions);\n\n  function closeCombo() {\n    $(listboxParams.comboboxSelector).attr(\"aria-expanded\", \"false\");\n    $(listboxParams.listboxSelector).removeClass(\"show-content\");\n  }\n\n  function options(listOptions) {\n    var\n      optionId,\n      optionText,\n      optionHtml;\n    $.each(listOptions, function() {\n      $(this).on(\"keypress click\", function(event) {\n        if (event.which === 13 || event.type === 'click') {\n          optionId = $(this).attr(\"id\");\n          optionText = $(this).text();\n          optionHtml = $(this).html();\n          $(this).parent().prev()\n            .attr(\"aria-activedescendant\", optionId)\n          \n          if (listboxParams.type === 'cInputPredictive') {\n            $(this).parent().prev()\n              .attr(\"value\", $.trim(optionText));\n          } else if (listboxParams.type === 'cSelect') {\n            $(this).parent().prev().find('.c-select__option-selected')\n              .html(optionHtml);\n          } else {\n            $(this).parent().prev().find(\"input\")\n              .attr(\"value\", $.trim(optionText));\n          }\n          \n          $(this).attr(\"aria-selected\", \"true\");\n          $(this).siblings().removeAttr(\"aria-selected\");\n          closeCombo();\n        };\n      });\n    });\n  }\n\n  function labelFloated(target) {\n    var combo = target.closest(listboxParams.mainSelector);\n    var comboValue = target.find(\"input\").val();\n    if (combo.length) {\n      target.parent().prev().addClass(\"is-floated\");\n    }\n  }\n\n  $(listboxParams.comboboxSelector).each(function() {\n    var childSelected= $(\"[aria-selected]\",$(this).siblings(\"ul\")),\n      combo = $(this).closest(listboxParams.mainSelector),\n      comboValue = null;\n\n    if (listboxParams.type === 'cInputPredictive') {\n      comboValue = $(this).val();\n    } else if (listboxParams.type === 'cSelect') {\n      comboValue = $(this).find('.c-select__option-selected').text();\n    } else {\n      comboValue = $(this).find(\"input\").val();\n    }\n\n      if ($(this).attr(\"aria-disabled\") === \"true\") {\n        $(this).attr(\"tabindex\", \"-1\");\n      }\n    \n    if (childSelected.length > 0) {\n      $(this).attr('aria-activedescendant',childSelected.attr('id'));\n      \n      if (listboxParams.type === 'cInputPredictive') {\n        $(this).val(childSelected.text());\n      } else {\n        $(listboxParams.inputSelector ,this).val(childSelected.text());\n      }\n    } else {\n      $(this).removeAttr(\"aria-activedescendant\");\n    }\n\n    if (comboValue.length > 0 && combo.length) {\n      $(this).parent().prev().addClass(\"is-floated\");\n    }\n  });\n\n\n  $(listboxParams.comboboxSelector).on(\"keypress click\", function(event) {\n    if (!$(this).is(listboxParams.disabledSelector) && !$(this).is('[readonly], [aria-readonly=\"true\"]')) {\n      if (event.which === 13 || event.type === 'click') {\n        var listOptions = $(this).next().children();\n        if ($(this).is(\"[aria-expanded=true]\")) {\n          closeCombo();\n        } else {\n          closeCombo();\n          $(this).attr(\"aria-expanded\", \"true\");\n          $(this).next().addClass(\"show-content\");\n          options(listOptions);\n        }\n        labelFloated($(this).parent());\n      }\n    }\n  });\n};\n"],"file":"helpers.listbox.js"}