{"version":3,"sources":["coronita/components/c-select-box.js"],"names":["Coronita","clientflow","cSelectBox","CLASS_IS_DISABLED","userData","data","selectedOption","isDisabled","clickOption","ev","selectOption","currentTarget","emptyListbox","$refs","listbox","removeEvents","parentNode","removeChild","listboxKeyDown","currentActiveOption","uiCoronitaComponentsListbox","getActiveOption","inputDisable","classList","add","input","setAttribute","inputEnable","remove","removeAttribute","setEvents","inputGetValue","value","inputIsValid","Boolean","getAttribute","inputSetValue","querySelector","removeEventListener","Array","from","children","forEach","option","$activeOption","oldValue","newValue","setAriaSelected","id","triggerInputChange","checkActiveDescendant","addEventListener","updateListbox","listboxOptions","document","getElementById","uiCoronitaModulesValidation","init","$","validation","color","isReadonly","validateInput","validate","wrapper","hasValidation","options","disable","enable","getValue","setValue","isValid","update","ui","each","attr","split","is","isRequired","find"],"mappings":"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","sourcesContent":["// COMPONENT - c-select-box\r\n\r\nCoronita.clientflow.cSelectBox = (function () {\r\n  const CLASS_IS_DISABLED = 'is-disabled';\r\n\r\n  return function (userData) {\r\n    let data = {\r\n      selectedOption: null,\r\n      isDisabled: userData.isDisabled\r\n    };\r\n  \r\n    function clickOption(ev) {\r\n      selectOption(ev.currentTarget);\r\n    }\r\n  \r\n    function emptyListbox() {\r\n      if (data.$refs.listbox) {\r\n        removeEvents();\r\n        data.$refs.listbox.parentNode.removeChild(data.$refs.listbox);\r\n        data.$refs.listbox = null;\r\n      }\r\n      data.selectedOption = null;\r\n    }\r\n  \r\n    function listboxKeyDown(ev) {\r\n      data.$refs.currentActiveOption = uiCoronitaComponentsListbox.getActiveOption(\r\n        data\r\n      );\r\n      uiCoronitaComponentsListbox.listboxKeyDown(ev, data, { selectOption });\r\n    }\r\n  \r\n    function inputDisable() {\r\n      data.$refs.cSelectBox.classList.add(CLASS_IS_DISABLED);\r\n      data.$refs.input.setAttribute('disabled', 'true');\r\n      data.$refs.listbox.setAttribute('aria-disabled', 'true');\r\n      data.$refs.listbox.setAttribute('tabindex', '-1');\r\n      data.isDisabled = true;\r\n      removeEvents();\r\n    }\r\n  \r\n    function inputEnable() {\r\n      data.$refs.cSelectBox.classList.remove(CLASS_IS_DISABLED);\r\n      data.$refs.input.removeAttribute('disabled');\r\n      data.$refs.listbox.removeAttribute('aria-disabled');\r\n      data.$refs.listbox.setAttribute('tabindex', '0');\r\n      data.isDisabled = false;\r\n      setEvents();\r\n    }\r\n    function inputGetValue() {\r\n      return data.$refs.input.value;\r\n    }\r\n  \r\n    function inputIsValid() {\r\n      return !Boolean(data.$refs.listbox.getAttribute('aria-invalid')); // eslint-disable-line\r\n    }\r\n  \r\n    function inputSetValue(value) {\r\n      selectOption(data.$refs.listbox.querySelector(`[data-value=\"${value}\"]`));\r\n    }\r\n  \r\n    function removeEvents() {\r\n      data.$refs.listbox.removeEventListener('keydown', listboxKeyDown);\r\n      Array.from(data.$refs.listbox.children).forEach(function(option) {\r\n        option.removeEventListener('click', clickOption);\r\n      });\r\n    }\r\n  \r\n    function selectOption($activeOption) {\r\n      const oldValue = data.$refs.input.value;\r\n      if ($activeOption) {\r\n        const newValue = $activeOption.getAttribute('data-value');\r\n        uiCoronitaComponentsListbox.setAriaSelected($activeOption);\r\n        if (oldValue !== newValue) {\r\n          data.$refs.input.value = newValue;\r\n          data.selectedOption = $activeOption.id;\r\n          uiCoronitaComponentsListbox.triggerInputChange(data.$refs.input);\r\n        }\r\n        uiCoronitaComponentsListbox.checkActiveDescendant(\r\n          data.$refs.listbox,\r\n          data.$refs.listbox\r\n        );\r\n      }\r\n    }\r\n  \r\n    function setEvents() {\r\n      data.$refs.listbox.addEventListener('keydown', listboxKeyDown);\r\n      Array.from(data.$refs.listbox.children).forEach(function(option) {\r\n        option.addEventListener('click', clickOption);\r\n      });\r\n    }\r\n  \r\n    function updateListbox(listboxOptions, value) {\r\n      emptyListbox();\r\n      data.$refs.input.value = value || '';\r\n      data.$refs.listbox = document.getElementById(`c-listbox-${userData.id}`);\r\n      uiCoronitaComponentsListbox.checkActiveDescendant(\r\n        data.$refs.listbox,\r\n        data.$refs.listbox\r\n      );\r\n      uiCoronitaModulesValidation.init(\r\n        $(data.$refs.listbox),\r\n        $(data.$refs.cSelectBox),\r\n        userData.validation || {},\r\n        userData.color\r\n      );\r\n      if (!data.isDisabled && !userData.isReadonly) {\r\n        setEvents();\r\n      }\r\n    }\r\n\r\n    function validateInput() {\r\n      return uiCoronitaModulesValidation.validate(\r\n        data.$refs.input.value,\r\n        userData.validation,\r\n        $(data.$refs.cSelectBox)\r\n      );\r\n    }\r\n  \r\n    function init() {\r\n      const cSelectBox = document.getElementById(`c-select-box-${userData.id}`);\r\n      data.$refs = {\r\n        cSelectBox: cSelectBox,\r\n        wrapper: cSelectBox.querySelector('[data-coronita-c-select-box-listbox]'),\r\n        listbox: null,\r\n        input: cSelectBox.querySelector('input'),\r\n        currentActiveOption: null\r\n      };\r\n  \r\n      if (userData.hasValidation) {\r\n        $(data.$refs.cSelectBox).data('validate', validateInput);\r\n      }\r\n  \r\n      updateListbox(userData.options, userData.value);\r\n    }\r\n  \r\n    return {\r\n      init: init,\r\n      disable: inputDisable,\r\n      enable: inputEnable,\r\n      getValue: inputGetValue,\r\n      setValue: inputSetValue,\r\n      isValid: inputIsValid,\r\n      validate: validateInput,\r\n      update: updateListbox\r\n    };\r\n  };\r\n})();\r\n\r\nCoronita.ui.cSelectBox = (function () {\r\n  function init () {\r\n    $('[data-coronita-c-select-box]').each(function () {\r\n      var cSelectBox = Coronita.clientflow.cSelectBox({\r\n        id: $(this).attr('id').split('c-select-box-')[1],\r\n        isDisabled: $(this).is('.is-disabled'),\r\n        isReadonly: $(this).is('.is-readonly'),\r\n        isRequired: $(this).find('[data-coronita-c-listbox]').is('[aria-required=\"true\"]')\r\n      });\r\n      cSelectBox.init();\r\n    });\r\n  }\r\n\r\n  return {\r\n    init\r\n  };\r\n})();\r\n"],"file":"c-select-box.js"}