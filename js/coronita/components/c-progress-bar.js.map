{"version":3,"sources":["coronita/components/c-progress-bar.js"],"names":["BbvaInfographic","container","properties","items","querySelectorAll","selectors","class","limits","min","chart","max","window","navigator","vendor","browser","legend","singleValue","legendSimple","factor","amount","limit","item","pseudo","prop","scope","getComputedStyle","value","getPropertyValue","format","decimalsLength","undefined","decimals","Math","floor","string","slice","document","createElement","decimalsContent","setAttribute","valueClass","units","sliceDecimals","innerHTML","parseInt","toLocaleString","code","appendChild","index","cssPropertyValue","thisValue","result","unit","type","getAttribute","attrVal","getSliceValue","console","log","barsDelay","getCssProperty","split","buildRadialInfo","blankLayer","thisTarget","parentNode","valueElement","formatValue","showTotal","valueTotal","forEach","setValues","progressRadial0","attrMax","progressRadial1","progressRadial2","progressRadial3"],"mappings":"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","sourcesContent":["'use strict'\n\n// container: el id del componente gráfica que pinta\n// properties: objeto con las propiedades que va a pintar\nclass BbvaInfographic {\n  constructor (container, properties) {\n    this.container = container\n    this.properties = properties\n    this.items = this.container.querySelectorAll(this.properties.selectors.class)\n    this.limits = {\n      min: this.properties.chart.min,\n      max: this.properties.chart.max\n    }\n\n    if (window.navigator.vendor === 'Apple Computer, Inc.') {\n      this.browser = 'apple'\n    }\n\n    // if (this.properties.selectors.tooltip) {\n    //   this.tooltip = true\n    // }\n\n    if (this.properties.chart.legend) {\n      this.legend = this.container.querySelectorAll(this.properties.chart.legend.class)[0]\n      if (this.properties.chart.legend.singleValue) {\n        this.legendSimple = true\n      }\n    }\n  }\n  // addTooltipValue (element, value) {\n  //   let thisValue = this.formatValue(value)\n  //   element.querySelectorAll(this.properties.selectors.tooltip)[0].appendChild(thisValue)\n  // }\n  getSliceValue (factor, amount, limit) {\n    return (factor * amount) / limit\n  }\n  getCssProperty (item, pseudo, prop) {\n    const scope = window.getComputedStyle(item, pseudo)\n    const value = scope.getPropertyValue(prop)\n    return value\n  }\n  sliceDecimals (value) {\n    let amount\n    if (this.properties.chart.format.decimalsLength !== undefined) {\n      amount = this.properties.chart.format.decimalsLength\n    } else {\n      amount = 2\n    }\n    let decimals = (value - Math.floor(value)) + ''\n    let string = decimals.slice(2, 2 + amount)\n    return string\n  }\n  formatValue (value) {\n    let container = document.createElement('span')\n    let decimals = document.createElement('sup')\n    let decimalsContent\n\n    container.setAttribute('class', this.properties.chart.legend.valueClass)\n\n    if (value % 1 === 0) {\n      decimalsContent = this.properties.chart.units\n    } else {\n      decimalsContent = this.sliceDecimals(value) + this.properties.chart.units\n    }\n\n    decimals.innerHTML = decimalsContent\n\n    container.innerHTML = parseInt(value).toLocaleString(this.properties.chart.format.code)\n    container.appendChild(decimals)\n\n    return container\n  }\n  setValues (item, index) {\n    let cssPropertyValue\n    let thisValue\n    let result\n    let unit\n    switch (this.properties.chart.type) {\n      case 'bar':\n        thisValue = item.getAttribute(this.properties.selectors.attrVal)\n        result = this.getSliceValue(100, thisValue, this.limits.max)\n        console.log (result);\n        item.setAttribute('style', 'width: ' + result + '%; transition-delay: ' + (index * this.properties.chart.barsDelay) + 's;')\n        // if (this.tooltip === true) {\n        //   this.addTooltipValue(item, thisValue)\n        // }\n        break\n      case 'radial':\n        cssPropertyValue = this.getCssProperty(item, null, 'stroke-dasharray')\n        if (this.browser === undefined) {\n          cssPropertyValue = cssPropertyValue.split('px')[0]\n          unit = 'px'\n        } else {\n          cssPropertyValue = cssPropertyValue.split('em')[0]\n          unit = 'em'\n        }\n        thisValue = item.getAttribute(this.properties.selectors.attrVal)\n        result = cssPropertyValue - this.getSliceValue(cssPropertyValue, thisValue, this.limits.max)\n        item.setAttribute('style', 'stroke-dashoffset: ' + result + unit +\n        '; transition-delay: ' + (index * this.properties.chart.barsDelay * 2) + 's;')\n        if (this.legend !== undefined) {\n          this.buildRadialInfo(thisValue, item)\n        }\n        break\n    }\n  }\n  buildRadialInfo (value, item) {\n    let blankLayer = document.createElement('div')\n    let thisTarget = item.parentNode.parentNode.querySelectorAll(this.properties.chart.legend.class)[0]\n\n    let valueElement = this.formatValue(value)\n    blankLayer.appendChild(valueElement)\n\n    if (this.properties.chart.legend.showTotal) {\n      let valueTotal = this.formatValue(this.properties.chart.max)\n      blankLayer.appendChild(valueTotal)\n    }\n\n    thisTarget.appendChild(blankLayer)\n  }\n  start () {\n    this.items.forEach((item, index) => {\n      this.setValues(item, index)\n    })\n  }\n}\n\n\n\nconst progressRadial0 = {\n  selectors: {\n    attrVal: 'aria-valuenow',\n    attrMax: 'aria-valuemax',\n    class: '.infographic-progress__item'\n  },\n  chart: {\n    legend: {\n      class: '.infographic-progress__legend',\n      valueClass: 'infographic-progress__value',\n      showTotal: true\n    },\n    units: '€',\n    type: 'radial',\n    barsDelay: 0.05,\n    min: 0,\n    max: 1000,\n    format: {\n      code: 'en', // false value for locale auto-detection\n      decimalsLength: 2\n    }\n  }\n}\n\nconst progressRadial1 = {\n  selectors: {\n    attrVal: 'aria-valuenow',\n    attrMax: 'aria-valuemax',\n    class: '.infographic-progress__item'\n  },\n  chart: {\n    legend: {\n      class: '.infographic-progress__legend',\n      valueClass: 'infographic-progress__value',\n      showTotal: true\n    },\n    units: '€',\n    type: 'radial',\n    barsDelay: 0.05,\n    min: 0,\n    max: 2800,\n    format: {\n      code: 'en', // false value for locale auto-detection\n      decimalsLength: 1\n    }\n  }\n}\n\nconst progressRadial2 = {\n  selectors: {\n    attrVal: 'aria-valuenow',\n    attrMax: 'aria-valuemax',\n    class: '.infographic-progress__item'\n  },\n  chart: {\n    legend: {\n      class: '.infographic-progress__legend',\n      valueClass: 'infographic-progress__value'\n    },\n    units: '%',\n    type: 'radial',\n    barsDelay: 0.05,\n    min: 0,\n    max: 100,\n    format: {\n      code: 'en', // false value for locale auto-detection\n      decimalsLength: 0\n    }\n  }\n}\n\nconst progressRadial3 = {\n  selectors: {\n    attrVal: 'aria-valuenow',\n    attrMax: 'aria-valuemax',\n    class: '.infographic-progress__item'\n  },\n  chart: {\n    type: 'radial',\n    barsDelay: 0.05,\n    min: 0,\n    max: 100\n  }\n}\n\n//const container0 = document.getElementById('progress-bars')\n//const container1 = document.getElementById('progress-bars-1')\n// const container1 = document.getElementById('progress-bars-1')\n// const container1 = document.getElementById('progress-radial_0')\n// const container2 = document.getElementById('progress-radial_1')\n// const container3 = document.getElementById('progress-radial_2')\n// const container4 = document.getElementById('progress-radial_3')\n\n//let ProgressBars = new BbvaInfographic(container0, progressBars)\n//let ProgressBars1 = new BbvaInfographic(container1, progressBars)\n// let ProgressBars1 = new BbvaInfographic(container1, progressBars1)\n// let ProgressRadial0 = new BbvaInfographic(container1, progressRadial0)\n// let ProgressRadial1 = new BbvaInfographic(container2, progressRadial1)\n// let ProgressRadial2 = new BbvaInfographic(container3, progressRadial2)\n// let ProgressRadial3 = new BbvaInfographic(container4, progressRadial3)\n\n//ProgressBars.start()\n//ProgressBars1.start()\n// ProgressBars1.start()\n// ProgressRadial0.start()\n// ProgressRadial1.start()\n// ProgressRadial2.start()\n// ProgressRadial3.start()\n"],"file":"c-progress-bar.js"}