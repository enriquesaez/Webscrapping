{"version":3,"sources":["coronita/components/c-input-file.js"],"names":["Coronita","clientflow","CInputFile","userData","uiCoronitaModulesValidation","FILE_NAME_LENGTH","CLASS_DRAG_ACTIVE","CLASS_FOCUS_ACTIVE","CLASS_IMAGE_HORIZONTAL","CLASS_IMAGE_VERTICAL","data","addFile","files","length","file","checkFile","fileName","name","modifier","imageSet","toggleView","setFileName","setResetButton","onCheckedFile","$refs","inputFile","value","focus","allowedExtension","extension","validation","type","allowed","transverser","get","find","e","valid","size","max","min","emitError","error","split","emitSuccess","clickReset","forEach","eventName","resetButton","addEventListener","onResetInput","dragAndDrop","dropArea","view","querySelectorAll","onDragEnterOver","onDragLeave","onDrop","ev","disabled","preventDefault","classList","add","remove","stopPropagation","target","dataTransfer","callInvalid","statusInvalid","$view","focusActive","onfocus","onblur","getFileName","ext","substr","imageReset","querySelector","innerHTML","reader","FileReader","onload","preview","result","image","imageClass","offsetWidth","offsetHeight","readAsDataURL","isClick","indexOf","keyCode","onFileChange","resetInput","setAttribute","resetFileName","onClearedFile","visibleFileName","textContent","resetButtonDefaultText","getAttribute","fileViews","toggle","init","refView","document","getElementById","id","$","ui","CInputfile","each","index","item","coronitaCInputFile","is","attr","inputId","eq"],"mappings":"AAAA;AAEAA,QAAQ,CAACC,UAAT,CAAoBC,UAApB,GAAiC,UAAUC,QAAV,EAAoBC,2BAApB,EAAiD;AAChF,MAAMC,gBAAgB,GAAG,EAAzB;AACA,MAAMC,iBAAiB,GAAG,WAA1B;AACA,MAAMC,kBAAkB,GAAG,WAA3B;AACA,MAAMC,sBAAsB,GAAG,yCAA/B;AACA,MAAMC,oBAAoB,GAAG,uCAA7B;AAEA,MAAIC,IAAI,GAAG,EAAX;;AAEA,WAASC,OAAT,CAAkBC,KAAlB,EAAyB;AACvB,QAAI,CAACA,KAAK,CAACC,MAAX,EAAmB;AACjB;AACD;;AACD,QAAMC,IAAI,GAAGF,KAAK,CAAC,CAAD,CAAlB;;AACA,QAAIG,SAAS,CAACD,IAAD,CAAb,EAAqB;AACnBJ,MAAAA,IAAI,CAACM,QAAL,GAAgBF,IAAI,CAACG,IAArB;;AACA,UAAId,QAAQ,CAACe,QAAT,KAAsB,OAA1B,EAAmC;AACjCC,QAAAA,QAAQ,CAACL,IAAD,CAAR;AACD;;AACDM,MAAAA,UAAU;AACVC,MAAAA,WAAW;AACXC,MAAAA,cAAc;;AACd,UAAI,OAAOnB,QAAQ,CAACoB,aAAhB,KAAkC,UAAtC,EAAkD;AAChDpB,QAAAA,QAAQ,CAACoB,aAAT,CAAuBT,IAAvB;AACD;AACF,KAXD,MAWO;AACLJ,MAAAA,IAAI,CAACc,KAAL,CAAWC,SAAX,CAAqBC,KAArB,GAA6B,EAA7B;AACD;;AACDhB,IAAAA,IAAI,CAACc,KAAL,CAAWC,SAAX,CAAqBE,KAArB;AACD;;AAED,WAASC,gBAAT,CAA2BC,SAA3B,EAAsC;AACpC,QAAI1B,QAAQ,CAAC2B,UAAT,CAAoBC,IAApB,CAAyBC,OAAzB,CAAiCnB,MAArC,EAA6C;AAC3C,aAAOoB,WAAW,CAACC,GAAZ,CAAgB,yBAAhB,EAA2C,EAA3C,EAA+C/B,QAA/C,EACJgC,IADI,CACC,UAAAC,CAAC;AAAA,eAAIA,CAAC,KAAKP,SAAV;AAAA,OADF,CAAP;AAED;;AACD,WAAO,IAAP;AACD;;AAED,WAASd,SAAT,CAAoBD,IAApB,EAA0B;AACxB,QAAIuB,KAAK,GAAG,IAAZ;;AACA,QAAKlC,QAAQ,CAAC2B,UAAT,CAAoBQ,IAApB,CAAyBC,GAAzB,IAAgCpC,QAAQ,CAAC2B,UAAT,CAAoBQ,IAApB,CAAyBC,GAAzB,GAA+BzB,IAAI,CAACwB,IAArE,IACDnC,QAAQ,CAAC2B,UAAT,CAAoBQ,IAApB,CAAyBE,GAAzB,IAAgCrC,QAAQ,CAAC2B,UAAT,CAAoBQ,IAApB,CAAyBE,GAAzB,GAA+B1B,IAAI,CAACwB,IADvE,EAC8E;AAC5EG,MAAAA,SAAS,CAACtC,QAAQ,CAAC2B,UAAT,CAAoBQ,IAApB,CAAyBI,KAA1B,CAAT;AACAL,MAAAA,KAAK,GAAG,KAAR;AACD,KAJD,MAIO,IAAI,CAACT,gBAAgB,CAACd,IAAI,CAACiB,IAAL,CAAUY,KAAV,CAAgB,GAAhB,EAAqB,CAArB,CAAD,CAArB,EAAgD;AACrDF,MAAAA,SAAS,CAACtC,QAAQ,CAAC2B,UAAT,CAAoBC,IAApB,CAAyBW,KAA1B,CAAT;AACAL,MAAAA,KAAK,GAAG,KAAR;AACD,KAHM,MAGA;AACLO,MAAAA,WAAW;AACZ;;AACD,WAAOP,KAAP;AACD;;AAED,WAASQ,UAAT,GAAuB;AACrB,KAAC,OAAD,EAAU,OAAV,EAAmBC,OAAnB,CAA2B,UAAAC,SAAS,EAAI;AACtCrC,MAAAA,IAAI,CAACc,KAAL,CAAWwB,WAAX,CAAuBC,gBAAvB,CAAwCF,SAAxC,EAAmDG,YAAnD,EAAiE,KAAjE;AACD,KAFD;AAGD;;AAED,WAASC,WAAT,GAAwB;AACtB,QAAIC,QAAQ,GAAG1C,IAAI,CAACc,KAAL,CAAW6B,IAAX,CAAgBC,gBAAhB,CAAiC,4CAAjC,EAA+E,CAA/E,CAAf;AACA,KAAC,WAAD,EAAc,UAAd,EAA0BR,OAA1B,CAAkC,UAAAC,SAAS,EAAI;AAC7CK,MAAAA,QAAQ,CAACH,gBAAT,CAA0BF,SAA1B,EAAqCQ,eAArC,EAAsD,KAAtD;AACD,KAFD;AAGAH,IAAAA,QAAQ,CAACH,gBAAT,CAA0B,WAA1B,EAAuCO,WAAvC,EAAoD,KAApD;AACAJ,IAAAA,QAAQ,CAACH,gBAAT,CAA0B,MAA1B,EAAkCQ,MAAlC,EAA0C,KAA1C;AACD;;AAED,WAASF,eAAT,CAA0BG,EAA1B,EAA8B;AAC5B,QAAI,CAAChD,IAAI,CAACc,KAAL,CAAWC,SAAX,CAAqBkC,QAA1B,EAAoC;AAClCD,MAAAA,EAAE,CAACE,cAAH;AACAlD,MAAAA,IAAI,CAACc,KAAL,CAAW6B,IAAX,CAAgBQ,SAAhB,CAA0BC,GAA1B,CAA8BxD,iBAA9B;AACD;AACF;;AAED,WAASkD,WAAT,CAAsBE,EAAtB,EAA0B;AACxBA,IAAAA,EAAE,CAACE,cAAH;AACAlD,IAAAA,IAAI,CAACc,KAAL,CAAW6B,IAAX,CAAgBQ,SAAhB,CAA0BE,MAA1B,CAAiCzD,iBAAjC;AACD;;AAED,WAASmD,MAAT,CAAiBC,EAAjB,EAAqB;AACnB,QAAI,CAAChD,IAAI,CAACc,KAAL,CAAWC,SAAX,CAAqBkC,QAA1B,EAAoC;AAClCD,MAAAA,EAAE,CAACE,cAAH;AACAF,MAAAA,EAAE,CAACM,eAAH;AACAtD,MAAAA,IAAI,CAACc,KAAL,CAAW6B,IAAX,CAAgBQ,SAAhB,CAA0BE,MAA1B,CAAiCzD,iBAAjC;AACAK,MAAAA,OAAO,CAAC+C,EAAE,CAACO,MAAH,CAAUrD,KAAV,IAAmB8C,EAAE,CAACQ,YAAH,CAAgBtD,KAApC,EAA2CF,IAA3C,CAAP;AACD;AACF;;AAED,WAAS+B,SAAT,CAAoBC,KAApB,EAA2B;AACzB,QAAIyB,WAAW,GAAG/D,2BAA2B,CAACgE,aAA5B,IAA6ChE,2BAA/D;AACA+D,IAAAA,WAAW,CAACzD,IAAI,CAAC2D,KAAN,EAAa,IAAb,EAAmB3B,KAAnB,CAAX;AACD;;AAED,WAASE,WAAT,GAAwB;AACtB,QAAIuB,WAAW,GAAG/D,2BAA2B,CAACgE,aAA5B,IAA6ChE,2BAA/D;AACA+D,IAAAA,WAAW,CAACzD,IAAI,CAAC2D,KAAN,EAAa,KAAb,CAAX;AACD;;AAED,WAASC,WAAT,GAAwB;AACtB5D,IAAAA,IAAI,CAACc,KAAL,CAAWC,SAAX,CAAqB8C,OAArB,GAA+B,UAAUb,EAAV,EAAc;AAC3ChD,MAAAA,IAAI,CAACc,KAAL,CAAW6B,IAAX,CAAgBQ,SAAhB,CAA0BC,GAA1B,CAA8BvD,kBAA9B;AACD,KAFD;;AAGAG,IAAAA,IAAI,CAACc,KAAL,CAAWC,SAAX,CAAqB+C,MAArB,GAA8B,UAAUd,EAAV,EAAc;AAC1ChD,MAAAA,IAAI,CAACc,KAAL,CAAW6B,IAAX,CAAgBQ,SAAhB,CAA0BE,MAA1B,CAAiCxD,kBAAjC;AACD,KAFD;AAGD;;AAED,WAASkE,WAAT,GAAwB;AACtB,QAAI,CAAC/D,IAAI,CAACM,QAAV,EAAoB;AAClB;AACD;;AACD,QAAM0D,GAAG,GAAGhE,IAAI,CAACM,QAAL,CAAc2B,KAAd,CAAoB,GAApB,EAAyBjC,IAAI,CAACM,QAAL,CAAc2B,KAAd,CAAoB,GAApB,EAAyB9B,MAAzB,GAAkC,CAA3D,CAAZ;AACA,WAAOH,IAAI,CAACM,QAAL,CAAcH,MAAd,GAAuBR,gBAAvB,GACHK,IAAI,CAACM,QADF,aAEAN,IAAI,CAACM,QAAL,CAAc2D,MAAd,CAAqB,CAArB,EAAwBtE,gBAAxB,CAFA,iBAEgDqE,GAFhD,CAAP;AAGD;;AAED,WAASE,UAAT,GAAuB;AACrBlE,IAAAA,IAAI,CAACc,KAAL,CAAW6B,IAAX,CAAgBwB,aAAhB,CAA8B,4CAA9B,EAA4EC,SAA5E,GAAwF,EAAxF;AACD;;AAED,WAAS3D,QAAT,CAAmBL,IAAnB,EAAyB;AACvB,QAAIiE,MAAM,GAAG,IAAIC,UAAJ,EAAb;;AACAD,IAAAA,MAAM,CAACE,MAAP,GAAgB,UAAUvB,EAAV,EAAc;AAC5BhD,MAAAA,IAAI,CAACc,KAAL,CAAW0D,OAAX,CAAmBJ,SAAnB,iCAAmDpB,EAAE,CAACO,MAAH,CAAUkB,MAA7D;AACA,UAAMC,KAAK,GAAG1E,IAAI,CAACc,KAAL,CAAW0D,OAAX,CAAmBL,aAAnB,CAAiC,KAAjC,CAAd;AACA,UAAMQ,UAAU,GAAKD,KAAK,CAACE,WAAN,GAAoBF,KAAK,CAACG,YAA3B,GAA2C,CAA5C,GAAiD/E,sBAAjD,GAA0EC,oBAA7F;AACA2E,MAAAA,KAAK,CAACvB,SAAN,CAAgBC,GAAhB,CAAoBuB,UAApB;AACD,KALD;;AAMAN,IAAAA,MAAM,CAACS,aAAP,CAAqB1E,IAArB;AACD;;AAED,WAAS2E,OAAT,CAAkB/B,EAAlB,EAAsB;AACpB,WAAOA,EAAE,CAAC3B,IAAH,KAAY,OAAZ,IAAuB,CAAC,EAAD,EAAK,EAAL,EAAS2D,OAAT,CAAiBhC,EAAE,CAACiC,OAApB,MAAiC,CAAC,CAAhE;AACD;;AAED,WAASC,YAAT,CAAuBlC,EAAvB,EAA2B;AACzB/C,IAAAA,OAAO,CAAC+C,EAAE,CAACO,MAAH,CAAUrD,KAAV,IAAmB8C,EAAE,CAACQ,YAAH,CAAgBtD,KAApC,CAAP;AACD;;AAED,WAASiF,UAAT,GAAuB;AACrB,QAAInF,IAAI,CAACc,KAAL,CAAWC,SAAX,CAAqBC,KAArB,KAA+B,EAAnC,EAAuC;AACrC,UAAMZ,IAAI,GAAGJ,IAAI,CAACc,KAAL,CAAWC,SAAX,CAAqBb,KAArB,IAA8BF,IAAI,CAACc,KAAL,CAAWC,SAAX,CAAqBb,KAArB,CAA2B,CAA3B,CAA3C;AACAF,MAAAA,IAAI,CAACc,KAAL,CAAWwB,WAAX,CAAuB8C,YAAvB,CAAoC,YAApC,EAAkD,EAAlD;AACApF,MAAAA,IAAI,CAACM,QAAL,GAAgB,EAAhB;AACAN,MAAAA,IAAI,CAACc,KAAL,CAAWC,SAAX,CAAqBC,KAArB,GAA6B,EAA7B;AACAqE,MAAAA,aAAa;AACb3E,MAAAA,UAAU;;AACV,UAAIjB,QAAQ,CAACe,QAAT,KAAsB,OAA1B,EAAmC;AACjC0D,QAAAA,UAAU;AACX;;AACD,UAAI,OAAOzE,QAAQ,CAAC6F,aAAhB,KAAkC,UAAtC,EAAkD;AAChD7F,QAAAA,QAAQ,CAAC6F,aAAT,CAAuBlF,IAAvB;AACD;AACF;AACF;;AAED,WAASoC,YAAT,CAAuBQ,EAAvB,EAA2B;AACzB,QAAI+B,OAAO,CAAC/B,EAAD,CAAX,EAAiB;AACfhD,MAAAA,IAAI,CAACc,KAAL,CAAWC,SAAX,CAAqBE,KAArB;AACAkE,MAAAA,UAAU;AACX;AACF;;AAED,WAASE,aAAT,GAA0B;AACxBrF,IAAAA,IAAI,CAACc,KAAL,CAAWyE,eAAX,CAA2BH,YAA3B,CAAwC,OAAxC,EAAiD,EAAjD;AACApF,IAAAA,IAAI,CAACc,KAAL,CAAWyE,eAAX,CAA2BC,WAA3B,GAAyC,EAAzC;AACD;;AAED,WAAS7E,WAAT,GAAwB;AACtBX,IAAAA,IAAI,CAACc,KAAL,CAAWyE,eAAX,CAA2BH,YAA3B,CAAwC,OAAxC,EAAiDpF,IAAI,CAACM,QAAtD;AACAN,IAAAA,IAAI,CAACc,KAAL,CAAWyE,eAAX,CAA2BC,WAA3B,GAAyCzB,WAAW,EAApD;AACD;;AAED,WAASnD,cAAT,GAA2B;AACzB,QAAI6E,sBAAsB,GAAGzF,IAAI,CAACc,KAAL,CAAWwB,WAAX,CAAuBoD,YAAvB,CAAoC,kCAApC,CAA7B;AACA1F,IAAAA,IAAI,CAACc,KAAL,CAAWwB,WAAX,CAAuB8C,YAAvB,CAAoC,YAApC,EAAkDK,sBAAsB,GAAG,GAAzB,GAA+BzF,IAAI,CAACM,QAAtF;AACD;;AAED,WAASI,UAAT,GAAuB;AACrB,QAAIiF,SAAS,GAAG3F,IAAI,CAACc,KAAL,CAAW6B,IAAX,CAAgBC,gBAAhB,CAAiC,mCAAjC,CAAhB;AACA+C,IAAAA,SAAS,CAAC,CAAD,CAAT,CAAaxC,SAAb,CAAuByC,MAAvB,CAA8B,SAA9B;AACAD,IAAAA,SAAS,CAAC,CAAD,CAAT,CAAaxC,SAAb,CAAuByC,MAAvB,CAA8B,QAA9B;AACD;AAED;;;;;;;;;AAOA,WAASC,IAAT,GAAiB;AACf,QAAIC,OAAO,GAAGC,QAAQ,CAACC,cAAT,wBAAwCvG,QAAQ,CAACwG,EAAjD,EAAd;AACAjG,IAAAA,IAAI,CAAC2D,KAAL,GAAauC,CAAC,CAACJ,OAAD,CAAd;AACA9F,IAAAA,IAAI,CAACc,KAAL,GAAa;AACX6B,MAAAA,IAAI,EAAEmD,OADK;AAEX/E,MAAAA,SAAS,EAAEgF,QAAQ,CAACC,cAAT,wBAAwCvG,QAAQ,CAACwG,EAAjD,YAFA;AAGX3D,MAAAA,WAAW,EAAEwD,OAAO,CAAClD,gBAAR,CAAyB,oCAAzB,EAA+D,CAA/D,CAHF;AAIX2C,MAAAA,eAAe,EAAEO,OAAO,CAAClD,gBAAR,CAAyB,uCAAzB,EAAkE,CAAlE,CAJN;AAKX4B,MAAAA,OAAO,EAAEsB,OAAO,CAAC3B,aAAR,CAAsB,4CAAtB;AALE,KAAb;AAQAnE,IAAAA,IAAI,CAACc,KAAL,CAAWC,SAAX,CAAqBwB,gBAArB,CAAsC,QAAtC,EAAgD2C,YAAhD;AACAtB,IAAAA,WAAW;AACXzB,IAAAA,UAAU;AACVM,IAAAA,WAAW;AACZ;;AAED,SAAO;AACLoD,IAAAA,IAAI,EAAJA,IADK;AAELV,IAAAA,UAAU,EAAVA,UAFK;AAGL9E,IAAAA,SAAS,EAATA;AAHK,GAAP;AAKD,CAxND;;AA0NAf,QAAQ,CAAC6G,EAAT,CAAYC,UAAZ,GAA0B,YAAY;AACpC,WAASP,IAAT,GAAiB;AACf,QAAMnG,2BAA2B,GAAG,SAA9BA,2BAA8B,GAAY;AAC9C,aAAO,IAAP;AACD,KAFD;;AAGAwG,IAAAA,CAAC,CAAC,8BAAD,CAAD,CAAkCG,IAAlC,CAAuC,UAAUC,KAAV,EAAiBC,IAAjB,EAAuB;AAC5D,UAAMC,kBAAkB,GAAGlH,QAAQ,CAACC,UAAT,CAAoBC,UAApB,CAA+B;AACxDgB,QAAAA,QAAQ,EAAE0F,CAAC,CAACK,IAAD,CAAD,CAAQE,EAAR,CAAW,sBAAX,IAAqC,OAArC,GAA+C,IADD;AAExDrF,QAAAA,UAAU,EAAE;AACVQ,UAAAA,IAAI,EAAE;AACJC,YAAAA,GAAG,EAAE,IADD;AAEJC,YAAAA,GAAG,EAAE;AAFD,WADI;AAKVT,UAAAA,IAAI,EAAE;AACJC,YAAAA,OAAO,EAAE;AADL;AALI,SAF4C;AAWxD2E,QAAAA,EAAE,EAAEC,CAAC,CAACK,IAAD,CAAD,CAAQG,IAAR,CAAa,IAAb,EAAmBzE,KAAnB,CAAyB,eAAzB,EAA0C,CAA1C,CAXoD;AAYxD0E,QAAAA,OAAO,EAAET,CAAC,CAACK,IAAD,CAAD,CAAQ9E,IAAR,CAAa,OAAb,EAAsBmF,EAAtB,CAAyB,CAAzB,EAA4BF,IAA5B,CAAiC,IAAjC;AAZ+C,OAA/B,EAaxBhH,2BAbwB,CAA3B;AAcA8G,MAAAA,kBAAkB,CAACX,IAAnB;AACD,KAhBD;AAiBD;;AAED,SAAO;AACLA,IAAAA,IAAI,EAAJA;AADK,GAAP;AAGD,CA3BwB,EAAzB","sourcesContent":["// COMPONENT - c-input-file\n\nCoronita.clientflow.CInputFile = function (userData, uiCoronitaModulesValidation) {\n  const FILE_NAME_LENGTH = 18;\n  const CLASS_DRAG_ACTIVE = 'is-moving';\n  const CLASS_FOCUS_ACTIVE = 'is-active';\n  const CLASS_IMAGE_HORIZONTAL = 'c-input-file__preview-image--horizontal';\n  const CLASS_IMAGE_VERTICAL = 'c-input-file__preview-image--vertical';\n\n  let data = {};\n\n  function addFile (files) {\n    if (!files.length) {\n      return;\n    }\n    const file = files[0];\n    if (checkFile(file)) {\n      data.fileName = file.name;\n      if (userData.modifier === 'image') {\n        imageSet(file);\n      }\n      toggleView();\n      setFileName();\n      setResetButton();\n      if (typeof userData.onCheckedFile === 'function') {\n        userData.onCheckedFile(file);\n      }\n    } else {\n      data.$refs.inputFile.value = '';\n    }\n    data.$refs.inputFile.focus();\n  }\n\n  function allowedExtension (extension) {\n    if (userData.validation.type.allowed.length) {\n      return transverser.get('validation.type.allowed', [])(userData)\n        .find(e => e === extension);\n    }\n    return true;\n  }\n\n  function checkFile (file) {\n    let valid = true;\n    if ((userData.validation.size.max && userData.validation.size.max < file.size) ||\n      (userData.validation.size.min && userData.validation.size.min > file.size)) {\n      emitError(userData.validation.size.error);\n      valid = false;\n    } else if (!allowedExtension(file.type.split('/')[1])) {\n      emitError(userData.validation.type.error);\n      valid = false;\n    } else {\n      emitSuccess();\n    }\n    return valid;\n  }\n\n  function clickReset () {\n    ['click', 'keyup'].forEach(eventName => {\n      data.$refs.resetButton.addEventListener(eventName, onResetInput, false);\n    });\n  }\n\n  function dragAndDrop () {\n    let dropArea = data.$refs.view.querySelectorAll('[data-coronita-c-input-file-drag-and-drop]')[0];\n    ['dragenter', 'dragover'].forEach(eventName => {\n      dropArea.addEventListener(eventName, onDragEnterOver, false);\n    });\n    dropArea.addEventListener('dragleave', onDragLeave, false);\n    dropArea.addEventListener('drop', onDrop, false);\n  }\n\n  function onDragEnterOver (ev) {\n    if (!data.$refs.inputFile.disabled) {\n      ev.preventDefault();\n      data.$refs.view.classList.add(CLASS_DRAG_ACTIVE);\n    }\n  }\n\n  function onDragLeave (ev) {\n    ev.preventDefault();\n    data.$refs.view.classList.remove(CLASS_DRAG_ACTIVE);\n  }\n\n  function onDrop (ev) {\n    if (!data.$refs.inputFile.disabled) {\n      ev.preventDefault();\n      ev.stopPropagation();\n      data.$refs.view.classList.remove(CLASS_DRAG_ACTIVE);\n      addFile(ev.target.files || ev.dataTransfer.files, data);\n    }\n  }\n\n  function emitError (error) {\n    let callInvalid = uiCoronitaModulesValidation.statusInvalid || uiCoronitaModulesValidation;\n    callInvalid(data.$view, true, error);\n  }\n\n  function emitSuccess () {\n    let callInvalid = uiCoronitaModulesValidation.statusInvalid || uiCoronitaModulesValidation;\n    callInvalid(data.$view, false);\n  }\n\n  function focusActive () {\n    data.$refs.inputFile.onfocus = function (ev) {\n      data.$refs.view.classList.add(CLASS_FOCUS_ACTIVE);\n    };\n    data.$refs.inputFile.onblur = function (ev) {\n      data.$refs.view.classList.remove(CLASS_FOCUS_ACTIVE);\n    };\n  }\n\n  function getFileName () {\n    if (!data.fileName) {\n      return;\n    }\n    const ext = data.fileName.split('.')[data.fileName.split('.').length - 1];\n    return data.fileName.length < FILE_NAME_LENGTH\n      ? data.fileName\n      : `${data.fileName.substr(0, FILE_NAME_LENGTH)}... ${ext}`;\n  }\n\n  function imageReset () {\n    data.$refs.view.querySelector('[data-coronita-c-input-file-image-preview]').innerHTML = '';\n  }\n\n  function imageSet (file) {\n    let reader = new FileReader();\n    reader.onload = function (ev) {\n      data.$refs.preview.innerHTML = `<img alt=\"\" src=\"${ev.target.result}\">`;\n      const image = data.$refs.preview.querySelector('img');\n      const imageClass = ((image.offsetWidth / image.offsetHeight) > 1) ? CLASS_IMAGE_HORIZONTAL : CLASS_IMAGE_VERTICAL;\n      image.classList.add(imageClass);\n    };\n    reader.readAsDataURL(file);\n  }\n\n  function isClick (ev) {\n    return ev.type === 'click' || [13, 32].indexOf(ev.keyCode) !== -1;\n  }\n\n  function onFileChange (ev) {\n    addFile(ev.target.files || ev.dataTransfer.files);\n  }\n\n  function resetInput () {\n    if (data.$refs.inputFile.value !== '') {\n      const file = data.$refs.inputFile.files && data.$refs.inputFile.files[0];\n      data.$refs.resetButton.setAttribute('aria-label', '');\n      data.fileName = '';\n      data.$refs.inputFile.value = '';\n      resetFileName();\n      toggleView();\n      if (userData.modifier === 'image') {\n        imageReset();\n      }\n      if (typeof userData.onClearedFile === 'function') {\n        userData.onClearedFile(file);\n      }\n    }\n  }\n\n  function onResetInput (ev) {\n    if (isClick(ev)) {\n      data.$refs.inputFile.focus();\n      resetInput();\n    }\n  }\n\n  function resetFileName () {\n    data.$refs.visibleFileName.setAttribute('title', '');\n    data.$refs.visibleFileName.textContent = '';\n  }\n\n  function setFileName () {\n    data.$refs.visibleFileName.setAttribute('title', data.fileName);\n    data.$refs.visibleFileName.textContent = getFileName();\n  }\n\n  function setResetButton () {\n    let resetButtonDefaultText = data.$refs.resetButton.getAttribute('data-coronita-c-input-file-reset');\n    data.$refs.resetButton.setAttribute('aria-label', resetButtonDefaultText + ' ' + data.fileName);\n  }\n\n  function toggleView () {\n    let fileViews = data.$refs.view.querySelectorAll('[data-coronita-c-input-file-view]');\n    fileViews[0].classList.toggle('sr-only');\n    fileViews[1].classList.toggle('hidden');\n  }\n\n  /**\n   * init method\n   * Call template mixin '_.c_coronita_c_input_file()' (c_coronita_c_input_file.tmpl.html) in the html file\n   * @param $view - jquery object container element selector\n   * @param data - object options\n   * @public\n   */\n  function init () {\n    let refView = document.getElementById(`c-input-file-${userData.id}`);\n    data.$view = $(refView);\n    data.$refs = {\n      view: refView,\n      inputFile: document.getElementById(`c-input-file-${userData.id}-input`),\n      resetButton: refView.querySelectorAll('[data-coronita-c-input-file-reset]')[0],\n      visibleFileName: refView.querySelectorAll('[data-coronita-c-input-file-filename]')[0],\n      preview: refView.querySelector('[data-coronita-c-input-file-image-preview]')\n    };\n\n    data.$refs.inputFile.addEventListener('change', onFileChange);\n    focusActive();\n    clickReset();\n    dragAndDrop();\n  }\n\n  return {\n    init,\n    resetInput,\n    checkFile\n  };\n};\n\nCoronita.ui.CInputfile = (function () {\n  function init () {\n    const uiCoronitaModulesValidation = function () {\n      return true;\n    };\n    $('[data-coronita-c-input-file]').each(function (index, item) {\n      const coronitaCInputFile = Coronita.clientflow.CInputFile({\n        modifier: $(item).is('.c-input-file--image') ? 'image' : null,\n        validation: {\n          size: {\n            max: null,\n            min: null\n          },\n          type: {\n            allowed: []\n          }\n        },\n        id: $(item).attr('id').split('c-input-file-')[1],\n        inputId: $(item).find('input').eq(0).attr('id')\n      }, uiCoronitaModulesValidation);\n      coronitaCInputFile.init();\n    });\n  }\n\n  return {\n    init\n  };\n})();\n"],"file":"c-input-file.js"}