{"version":3,"sources":["coronita/objects/o-carousel.js"],"names":["Coronita","clientflow","oCarousel","SELECTOR_CURRENT_SLIDE","ATTR_CAROUSEL_SLIDE","SELECTOR_CAROUSEL_CONTROLS_PREVIOUS","SELECTOR_CAROUSEL_CONTROLS_NEXT","SELECTOR_CAROUSEL_CONTROLS_BULLET","SELECTOR_CAROUSEL_SLIDE","CLASS_BULLET_ACTIVE","SELECTOR_CAROUSEL_STATUS","carouselEvent","$carousel","selector","callback","find","on","ev","isClick","getCurrentSlideIndex","parseInt","attr","type","keyCode","whichAnimationEvent","t","el","document","createElement","animations","style","undefined","init","$activeSlide","slideIndex","plusSlides","n","direction","showSlides","currentSlide","$slides","$bullets","index","transform","flag","length","concat","removeClass","focus","css","eq","addClass","siblings","text","e","originalEvent","propertyName","$","publish","id","currentTarget","ui","each"],"mappings":"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","sourcesContent":["// OBJECT - o-carousel\n\nCoronita.clientflow.oCarousel = (function () {\n  var SELECTOR_CURRENT_SLIDE = '[aria-hidden=\"false\"]';\n  var ATTR_CAROUSEL_SLIDE = 'data-coronita-o-carousel-slide';\n  var SELECTOR_CAROUSEL_CONTROLS_PREVIOUS = '[data-coronita-o-carousel-controls-arrow-previous]';\n  var SELECTOR_CAROUSEL_CONTROLS_NEXT = '[data-coronita-o-carousel-controls-arrow-next]';\n  var SELECTOR_CAROUSEL_CONTROLS_BULLET = '[data-coronita-o-carousel-controls-bullet]';\n  var SELECTOR_CAROUSEL_SLIDE = '[data-coronita-o-carousel-slide]';\n  var CLASS_BULLET_ACTIVE = 'o-carousel__bullet--active';\n  var SELECTOR_CAROUSEL_STATUS = '[data-coronita-o-carousel-status]';\n\n  function carouselEvent ($carousel, selector, callback) {\n    $carousel.find(selector).on('click keydown', function (ev) {\n      if (isClick(ev)) {\n        callback(ev);\n      }\n    });\n  }\n\n  function getCurrentSlideIndex ($carousel) {\n    return parseInt($carousel.find(SELECTOR_CURRENT_SLIDE).attr(ATTR_CAROUSEL_SLIDE), 10) + 1 || 1;\n  }\n\n  function isClick (ev) {\n    return ev.type === 'click' || ev.keyCode === 13 || ev.keyCode === 32;\n  }\n\n  function whichAnimationEvent () {\n    var t;\n    var el = document.createElement('fakeelement');\n    var animations = {\n      'animation': 'animationend',\n      'OAnimation': 'oAnimationEnd',\n      'MozAnimation': 'animationend',\n      'WebkitAnimation': 'webkitAnimationEnd'\n    };\n\n    for (t in animations) {\n      if (el.style[t] !== undefined) {\n        return animations[t];\n      }\n    }\n  }\n\n  /**\n   * init method\n   * Call template mixin '_.c_coronita_o_carousel()' (c_coronita_o_carousel.tmpl.html) in the html file\n   * Call init in *.mvc.js, for example in 'afterRender' method:\n   * uiCoronitaObjectsCarousel.init($oCarouselElement);\n   * @param $idElementContainer - jquery object element selector\n   * @public\n   */\n\n  function init ($carousel) {\n    var $activeSlide = $carousel.find('[aria-hidden=\"false\"]');\n    var slideIndex = getCurrentSlideIndex($carousel);\n\n    function plusSlides (n, direction) {\n      showSlides(slideIndex += n, direction);\n    }\n\n    function currentSlide (n, direction) {\n      showSlides(slideIndex = n, direction);\n    }\n\n    function showSlides (n, direction) {\n      var $slides = $carousel.find(SELECTOR_CAROUSEL_SLIDE);\n      var $bullets = $carousel.find(SELECTOR_CAROUSEL_CONTROLS_BULLET);\n      var index = slideIndex - 1;\n      var transform;\n      var flag = false;\n\n      if (n > $slides.length) {\n        slideIndex = 1;\n        index = 0;\n      }\n      if (n < 1) {\n        slideIndex = $slides.length;\n        index = $slides.length - 1;\n      }\n      transform = index === 0\n        ? 'translateX(0%)'\n        : 'translateX'.concat('(-', 100 * index, '%)');\n\n      $slides\n        .attr('aria-hidden', 'true')\n        .removeClass('invisible');\n      $activeSlide.focus();\n      $slides.css('transform', transform);\n      $activeSlide = $slides.eq(index);\n      $activeSlide.attr('aria-hidden', 'false');\n      $bullets\n        .eq(index)\n        .addClass(CLASS_BULLET_ACTIVE)\n        .siblings()\n        .removeClass(CLASS_BULLET_ACTIVE);\n      $carousel.find(SELECTOR_CAROUSEL_STATUS).text(slideIndex);\n\n      $carousel.on(whichAnimationEvent(), function (e) {\n        if (e.originalEvent.propertyName === 'transform' && !flag) {\n          flag = true;\n          $.publish('carousel:changeSlide', {\n            id: $carousel.attr('id'),\n            slideIndex: index\n          });\n          $activeSlide\n            .siblings()\n            .addClass('invisible');\n          $activeSlide.focus();\n        }\n      });\n    }\n\n    carouselEvent($carousel, SELECTOR_CAROUSEL_CONTROLS_PREVIOUS, function () {\n      plusSlides(-1, 'left');\n    });\n    carouselEvent($carousel, SELECTOR_CAROUSEL_CONTROLS_NEXT, function () {\n      plusSlides(1, 'right');\n    });\n    carouselEvent($carousel, SELECTOR_CAROUSEL_CONTROLS_BULLET, function (ev) {\n      var index = $carousel.find(SELECTOR_CAROUSEL_CONTROLS_BULLET).index(ev.currentTarget) + 1;\n      var direction = slideIndex < index ? 'right' : 'left';\n      currentSlide(index, direction);\n    });\n  }\n\n  return {\n    init: init\n  };\n})();\n\nCoronita.ui.oCarousel = (function ($carousel) {\n\n  function init () {\n    $('[data-coronita-o-carousel]').each(function () {\n      Coronita.clientflow.oCarousel.init($(this));\n    });\n  }\n\n  return {\n    init: init\n  };\n})();"],"file":"o-carousel.js"}