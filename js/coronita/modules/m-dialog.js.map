{"version":3,"sources":["coronita/modules/m-dialog.js"],"names":["Coronita","clientflow","mDialog","SELECTOR_BUTTON_CLOSE","ATTR_FOCUS_LIMIT","SELECTOR_FOCUS_LIMIT","overflowY","overflowHidden","$","css","isClick","ev","isButton","key","type","keyCode","getFocusables","$dialog","find","retainFocus","on","$focusables","position","attr","eq","length","focus","closeDialog","data","document","off","$link","openDialog","_","isFunction","callback","init","currentTarget","is","ui","each"],"mappings":"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","sourcesContent":["// MODULE - m-dialog\n\nCoronita.clientflow.mDialog = (function () {\n  var SELECTOR_BUTTON_CLOSE = '[data-coronita-m-dialog-close]';\n  var ATTR_FOCUS_LIMIT = 'data-coronita-m-dialog-focus-limit';\n  var SELECTOR_FOCUS_LIMIT = '[' + ATTR_FOCUS_LIMIT + ']';\n\n  function overflowY (overflowHidden) {\n    $('body').css({\n      'overflow-y': overflowHidden ? 'hidden' : ''\n    });\n  }\n\n  function isClick (ev, isButton) {\n    return ev.key === 'Enter' || ev.type === 'click' || (isButton && ev.keyCode === 32);\n  }\n\n  function getFocusables ($dialog) {\n    return $dialog.find('button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"], ' + SELECTOR_FOCUS_LIMIT + ')');\n  }\n\n  function retainFocus ($dialog) {\n    $dialog.find(SELECTOR_FOCUS_LIMIT).on('focus', function () {\n      var $focusables = getFocusables($dialog);\n      var position = $(this).attr(ATTR_FOCUS_LIMIT);\n      $focusables.eq(position === 'end' ? 0 : $focusables.length - 1).focus();\n    });\n  }\n\n  function closeDialog (data) {\n    $(document).off('keyup.dialog');\n    data.$dialog.attr('aria-hidden', 'true');\n    overflowY(false);\n    data.$link.focus();\n  }\n\n  function openDialog (data) {\n    var $dialog = data.$dialog;\n    $dialog.attr('aria-hidden', 'false');\n    overflowY(true);\n\n    $(document).on('keyup.dialog', function (ev) {\n      if (ev.keyCode === 27) {\n        closeDialog(data);\n      }\n    });\n\n    retainFocus($dialog);\n\n    if (_.isFunction(data.callback)) {\n      data.callback();\n    }\n\n    $('#' + $dialog.attr('id') + '-title').focus();\n  }\n\n  /**\n   * init method\n   * uiCoronitaModulesDialog.init(this.$el);\n   * @param $idViewContainer - jquery object container element selector\n   * @public\n   */\n  function init (data) {\n    data.$link.on('click keydown', function (ev) {\n      if (isClick(ev, $(ev.currentTarget).is('button, [role=\"button\"]'))) {\n        openDialog(data);\n      }\n    });\n    data.$dialog.find(SELECTOR_BUTTON_CLOSE)\n      .on('click keydown', function (ev) {\n        if (isClick(ev, true)) {\n          closeDialog(data);\n        }\n      });\n  }\n\n  return {\n    init: init\n  };\n})();\n\nCoronita.ui.mDialog = (function () {\n  return {\n    init: function () {\n      $('body').find('[data-coronita-m-dialog-link]').each(function () {\n        var $link = $(this);\n        Coronita.clientflow.mDialog.init({\n          $link: $link,\n          $dialog: $('#' + $link.attr('data-coronita-m-dialog-link'))\n        });\n      });\n    }\n  };\n})();\n"],"file":"m-dialog.js"}