{"version":3,"sources":["bbva.base.js"],"names":["$B","window","provide","ns","ns_string","parts","split","parent","pl","i","slice","length","modalOperativaNoEncontrada","data","modalType","modalId","modalTitle","app","literals","coreLiterals","operativa_no_encontrada_title","modalSubTitle","operativa_no_encontrada_subTitle","messageOptionsPage","operativa_no_encontrada_opcion_posicion_global","operativa_no_encontrada_opcion_hipotecas_y_prestamos","operativa_no_encontrada_opcion_seguros","operativa_no_encontrada_opcion_cuentas_y_tarjetas","operativa_no_encontrada_opcion_ahorro_e_inversion","content","_","c_mensajes_informativoRefuerzo2","selectedPage","ev","indexPage","$","currentTarget","val","urls","ui","dialog","destroy","router","navigate","coreNotification","id","title","dialogOptions","autoOpen","width","close","open","cSelectMenu","truncateText","clientFlow","utils","isLegacyIE","addClass","prop","on","modalBrowserNotCompatible","options","browserNotCompatible","message","closeOnEscape","logoutOnClose","sessionManager","logout","hideCloseBtn","find","hide","noRoute","route","rbaControl","destroyAll","exists","appConfig","enableBlockUserOperationsWhenLackData","clientResources","user","get","contains","rutasBloqueadasRBA","userInfoView","lanzarModalUsuarioBloqueadoRBA","errorGenerico","error","el","c_v06_contenedores_ventanaModal","html","isUndefined","create","isCore","zIndex","viewLoaded","viewId","viewCtor","View","moduleId","initialize","serializeForm","form","model","binder","Binder","PropertyAccessor","attributes","keyValues","l","objArray","key","value","jQuery","each","item","$item","_value","parseInt","dateValue","utcDateValue","isNaN","Date","getTimezoneOffset","map","serializeArray","isObject","isString","name","replace","set","validateForm","validate","prepareErrorTmplMsg","e","msg","error_tempalte","modelUrl","modelViewStateId","url","isFunction","viewStateId","mensage_de_error","tryGetTemplate","template","resultErrorMsg","toJSON","log","errorTemplate","tt","helper","trackErrorTmpl","setCookie","expire","d","setTime","getTime","toGMTString","document","cookie","getCookie","nameEQ","cookies","charAt","substring","indexOf","deleteCookie","getResourcePath","view","hasClientFlow","path","staticPath","fileName","script","tmpl","tmplPrefix","version","flow","getFucCoordinates","code","callback","TypeError","fuc_must_be_string","resp","xhr","XMLHttpRequest","onreadystatechange","readyState","status","JSON","parse","responseText","send","getGeolocationByOffice","office","office_must_be_string","ajax","hubo_un_error","success","showConfirm","onbeforeunload","subscribe","ajaxError","jqxhr","settings","exception","dynPath","location","href","stringify","description","showButton","buttonDataAttribute","viewCid","$template","c_v07_mensajes_errorAplicacion","titulo","descripcion","error_inesperado","dataAttr","validationErrorTemplate","descriptions","isNull","c_mensajes_alerta_servervalidation","warningTemplate","c_mensajes_alerta_aviso","reloadSpi","hash","reloadAppUrl","showLoading","text","c_v06_mensajes_cargando","cargando","image","prepareToTryToNavigateTo","showNavigateLoading","resetBuscador","GraphicChartsColors","loadingClass","loadingOverlayClass","navigationLoading","show","overlayClass","initialLoading","errorInInitialStaticLoad","initialStaticLoad","hideLoading","removeClass","checkModalClosedAndExecNavigation","callbackFn","callbackArgs","callbackContext","checker","invalidDataParameters","context","params","apply","setTimeout","fragment","Backbone","history","trigger","subscribes","viewSubscribes","event","hasOwnProperty","bind","checkViewOptions","excludes","option","isArray","checkModelAttributes","attr","scroll","publish","signature","viewStates","eventsId","checkEventId","eventIdToCheck","eventId","checkViewStateId","viewStateToCheck","viewState","evaluarMetodoFirmaSegundoNivel","methods","methods2Lv","setEventId","doReturn","setSimpleMethods","clearMethods","pluck","dom_toggleDisableState","stopPropagation","changevisibility","dialogCenter","setApperance","SingleStepView","$el","checkSecondLevelMethodsAssociated","$associatedDomMethod","secondLevelMethods","click","dom_prepareDomMethods","listSecondLevelMethods","error_no_metodos_firma","parentViewCid","aria","alertDialog","switcher","element","tabs","tabsChildren","selected","dom_initStatus","DNIe","DNIeTimeout","_counterAppletReady","_secondsTryingCheckingAppletReady","_checkingApplet","alreadyLaunchedApplet","getApplet","appletInitialize","_setViewParameters","_checkAppletReady","launchApplet","launch","appletCheckDone","self","applet","dseventdone","_proccessResponse","appletCorrect","viewModel","save","desafio","output","userCertificate","getCertificate","_eventId","jsonResp","operacionResultado","parseJSON","_showServerError","operacionMensaje","DNIe_customSuccess","remove","processDNIeSignedCorrectly","validationError","appletError","errorTitle","errorMsg","appletDnie","getError","updateJava","aviso","_showAppletError","isAppletReady","dseventready","isOnTime","appletResult","$wrapper","children","append","$containerErrorAndRetryButton","_toggleVisibilityOnErrorApplet","before","type","$loadingAndInfoRetryLayers","$wrapperMultipleOptionFirsLevel","closest","$applet","appletContainer","appletTag","extend","DNIeCustom","DNIeObj","overrideMethods","customMethods","selectorWrapperError","selectorWrapperApplet","$wrapperError","$wrapperApplet","off","empty","init","keyStoreCertificados","mostrarInformacionInterviniente","checkContentHeightDialogs","ultimoHeight","isActiveInterval","frequency","domModalSelector","modalInterval","checkModalHeight","removeInterval","posScroll","initInterval","setInterval","enableTabletFeatures","capabilities","touch","scrollTop","clearInterval","heightActual","filter","is","height","dialogHasSecureHeight","switchOperativa","ocultarPaso","$contenedorOperativas","$modal","eq","duplicarBotonCerrar","$botonCerrar","$newBotonCerrar","clone","removeAttr","mostrarPaso","selectorContenedor","tituloAnterior","capaAutoloadHTML","$trower","AppView","prototype","prepareAutoload","objParam","isSwitchOperativa","isInDom","setLinkedInterval","interval","fn","wrapper","intervalId","heartBeat","heartBeatId","applyCallback","checkAndPreparePublicRoute","isPublic","publicPath","getUrlPatternFromModelUrl","urlModel","urlPatternResult","processedUrlModel","replaceParams","urlRegExp","exec","param","routeExistRegExp","routeExists","getMergedTmpl","tries","async","mergedTmpl","timeout","dataType","body","gmaps","stack","checkGmapsAndApplyCallback","loadGmap","require","google","when","o","done","push","getExtraDeps","extraDepsLoaded","unsubscribe","showEndSessionWarning","contenidoAviso","tittle","alerta_sesion_expirada","alerta_sesion_expirada_recargar","prepend","css","outerHeight","injectElementWithStyles","rule","nodes","testnames","style","ret","node","docOverflow","mod","docElement","documentElement","div","createElement","fakeBody","appendChild","join","innerHTML","background","overflow","parentNode","removeChild","getTouchCapabilities","bool","prefixes","DocumentTouch","offsetTop","getFlashSupport","navigator","plugins","flash"],"mappings":"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","sourcesContent":["(function() {\r\n  /*\\\r\n   * $B\r\n   * Global namespace for BBVA\r\n  \\*/\r\n  $B = window.$B || {};\r\n\r\n  /*\\\r\n   * $B.provide\r\n   [ method ]\r\n   * Creates a namespace in the global\r\n   * $B namespace.\r\n   > Arguments\r\n   - ns (object) Object in which to create this namespace\r\n   - ns_string (string) Name for this namespace\r\n   > Usage\r\n   | $B.provide($B, 'app')\r\n  \\*/\r\n  $B.provide = function(ns, ns_string) {\r\n    var parts = ns_string.split('.'),\r\n      parent = ns,\r\n      pl, i;\r\n    if (parts[0] === '$B') {\r\n      parts = parts.slice(1);\r\n    }\r\n    pl = parts.length;\r\n    for (i = 0; i < pl; i += 1) {\r\n      if (typeof parent[parts[i]] === 'undefined') {\r\n        parent[parts[i]] = {};\r\n      }\r\n      parent = parent[parts[i]];\r\n    }\r\n    return parent;\r\n  };\r\n\r\n  /**\r\n   * Modal Operativa no encontrada\r\n   */\r\n\r\n  $B.modalOperativaNoEncontrada = function() {\r\n    var data = {\r\n        modalType: 'modalesAvisoCore',\r\n        modalId: 'operativaNoEncontrada',\r\n        // modal Header\r\n        modalTitle: $B.app.literals.coreLiterals.operativa_no_encontrada_title,\r\n        modalSubTitle: $B.app.literals.coreLiterals.operativa_no_encontrada_subTitle,\r\n        // modal info\r\n        messageOptionsPage: [\r\n          $B.app.literals.coreLiterals.operativa_no_encontrada_opcion_posicion_global,\r\n          $B.app.literals.coreLiterals.operativa_no_encontrada_opcion_hipotecas_y_prestamos,\r\n          $B.app.literals.coreLiterals.operativa_no_encontrada_opcion_seguros,\r\n          $B.app.literals.coreLiterals.operativa_no_encontrada_opcion_cuentas_y_tarjetas,\r\n          $B.app.literals.coreLiterals.operativa_no_encontrada_opcion_ahorro_e_inversion\r\n        ]\r\n      },\r\n      content = _.c_mensajes_informativoRefuerzo2(data),\r\n      selectedPage = function(ev) {\r\n        var indexPage = $(ev.currentTarget).val(),\r\n          urls = [\r\n            'posicion-global',\r\n            'subhome-cuentas-tarjetas',\r\n            'subhome-creditos-hipotecas',\r\n            'subhome-ahorro-inversion',\r\n            'subhome-seguros'\r\n          ];\r\n        $B.ui.dialog.destroy('dialogNoRoute');\r\n        window.router.navigate(urls[indexPage], true);\r\n      };\r\n\r\n    $B.coreNotification({\r\n      id: 'dialogNoRoute',\r\n      content: content,\r\n      title: '',\r\n      dialogOptions: {\r\n        autoOpen: true,\r\n        width: 640,\r\n        close: function() {\r\n          $B.ui.dialog.destroy('dialogNoRoute');\r\n        },\r\n        open: function() {\r\n          $('#js-comboOptionsPage').cSelectMenu({\r\n            truncateText: false\r\n          });\r\n          if ($B.clientFlow.utils.isLegacyIE()) {\r\n            $('.modal-image-background').addClass('no-svg');\r\n          }\r\n          $('#js-comboOptionSelected').prop('selectedIndex', -1);\r\n          $('#js-comboOptionSelected').on('change', selectedPage);\r\n\r\n        }\r\n      }\r\n    });\r\n\r\n  };\r\n\r\n  /**\r\n   * Modal Operativa Bloqueada por incompatiblidad de Browser\r\n   */\r\n\r\n  $B.modalBrowserNotCompatible = function(options) {\r\n    var data = {\r\n        modalType: 'modalesAvisoCore',\r\n        modalId: 'browserNotCompatible',\r\n        // modal Header\r\n        modalTitle: $B.app.literals.browserNotCompatible.modalTitle,\r\n        modalSubTitle: options.message\r\n      },\r\n      content = _.c_mensajes_informativoRefuerzo2(data);\r\n\r\n    $B.coreNotification({\r\n      id: 'browserNotCompatible',\r\n      content: content,\r\n      title: '',\r\n      dialogOptions: {\r\n        autoOpen: true,\r\n        width: 640,\r\n        closeOnEscape: options.closeOnEscape || true,\r\n        close: function() {\r\n          $B.ui.dialog.destroy('browserNotCompatible');\r\n\r\n          if(options.logoutOnClose) {\r\n            $B.sessionManager.logout();\r\n          }\r\n        },\r\n        open: function() {\r\n          if ($B.clientFlow.utils.isLegacyIE()) {\r\n            $('.modal-image-background').addClass('no-svg');\r\n          }\r\n\r\n          if(options.hideCloseBtn) {\r\n            $(this).find('#browserNotCompatible .cerrarModal').hide();\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n  };\r\n\r\n  /*\\\r\n   * $B.noRoute\r\n   [ method ]\r\n   * Function that displays a modal dialog when\r\n   * a route is not defined in our applications routes\r\n   > Arguments\r\n   - route (string) Name/URI for this route\r\n   > Usage\r\n   | $B.noRoute('nonexisting')\r\n  \\*/\r\n  $B.noRoute = function(route) {\r\n    var rbaControl = false;\r\n\r\n    $B.ui.dialog.destroyAll();\r\n    if ($B.ui.dialog.exists('loading-app')) {\r\n      $B.ui.dialog.destroy('loading-app');\r\n    }\r\n    // Control por si el usuario tiene operativas bloqueadas por RBA\r\n    if ($B.appConfig.enableBlockUserOperationsWhenLackData && $B.clientResources.user.get('usuarioBloqueadoRBA')) {\r\n      // Devuelve true si route es una operativa bloqueada por RBA\r\n      rbaControl = _.contains($B.appConfig.rutasBloqueadasRBA, route);\r\n    }\r\n\r\n    if (rbaControl) {\r\n      // Operativas Bloqueadas por RBA, mostraría el modal de usuario bloqueado RBA.\r\n      $B.userInfoView.lanzarModalUsuarioBloqueadoRBA();\r\n    } else {\r\n      // Operativas Bloqueadas, mostraría el modal de Página no encontrada.\r\n      $B.modalOperativaNoEncontrada();\r\n    }\r\n  };\r\n\r\n  $B.errorGenerico = function(error, message) {\r\n    if ($B.ui.dialog.exists('loading-app')) {\r\n      $B.ui.dialog.destroy('loading-app');\r\n    }\r\n    $B.coreNotification({\r\n      id: 'serverError',\r\n      content: '<p><strong>' + error + ':</strong> ' + message + '</p>',\r\n      title: 'Error',\r\n      width: 'w640'\r\n    });\r\n  };\r\n\r\n\r\n  /*\\\r\n   * $B.coreNotification\r\n   [ method ]\r\n   * Function that creates a core modal notification\r\n   * will not be destroyed unless call explicit destroy() passing its id\r\n   * It is used at the end of all MVCs\r\n   > Arguments\r\n   - options (object) object of name/value pairs\r\n   o {\r\n   o    id (string) id for the dialog must be unique\r\n   o    content (string) html string content\r\n   o    title (string) title for the dialog (temporal, should be on the tmpl)\r\n   o }\r\n   > Usage\r\n   | $B.coreNotification({\r\n   |  id: 'serverError',\r\n   |  content: '<p>Hubo un error</p>',\r\n   |  title: 'Error'\r\n   | });\r\n  \\*/\r\n  $B.coreNotification = function(options) {\r\n    var el = _.c_v06_contenedores_ventanaModal(options);\r\n    if ($B.ui.dialog.exists(options.id)) {\r\n      $B.ui.dialog.get(options.id).html(el).dialog('open');\r\n    } else {\r\n      if (!_.isUndefined(options.dialogOptions)) {\r\n        $B.ui.dialog.create({\r\n          id: options.id,\r\n          content: el,\r\n          isCore: true,\r\n          dialogOptions: options.dialogOptions\r\n        });\r\n      } else {\r\n        $B.ui.dialog.create({\r\n          id: options.id,\r\n          content: el,\r\n          isCore: true,\r\n          dialogOptions: {\r\n            zIndex: 100000,\r\n            autoOpen: true\r\n          }\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n\r\n  /*\\\r\n   * $B.viewLoaded\r\n   [ method ]\r\n   * Function that triggers viewLoaded\r\n   * It is used at the end of all MVCs\r\n   > Arguments\r\n   - viewId (string) jQuery dom form object\r\n   - viewCtor (object) Instance of a Backbone View\r\n   > Usage\r\n   | $B.viewLoaded(moduleId, StackView)\r\n   * or if StackView was declared passing the id directly just use:\r\n   | $B.viewLoaded(StackView)\r\n  \\*/\r\n  $B.viewLoaded = function(viewId, viewCtor) {\r\n    // accept viewId to be the view itself\r\n    // and get the id from its id property\r\n    var View, id;\r\n    if (viewCtor) {\r\n      View = viewCtor;\r\n      View.id = viewId;\r\n    } else {\r\n      View = viewId;\r\n      viewId = null;\r\n    }\r\n\r\n    id = View.id || View.moduleId || viewId;\r\n\r\n    if (!id) {\r\n      throw 'moduleId is undefined';\r\n    }\r\n\r\n    return {\r\n      id: id,\r\n      initialize: function(options) {\r\n        return new View(options);\r\n      }\r\n    };\r\n  };\r\n\r\n\r\n  /*\\\r\n   * $B.serializeForm\r\n   [ method ]\r\n   * Serializes a form and binds it's values to a Backbone Model\r\n   > Arguments\r\n   - form (object) jQuery dom form object\r\n   - model (object) Instance of a Backbone Model\r\n   > Usage\r\n   | $B.serializeForm($('#myForm'), model)\r\n  \\*/\r\n  $B.serializeForm = function(form, model) {\r\n    var binder = new Binder.PropertyAccessor(model.attributes),\r\n      keyValues,\r\n      i,\r\n      l,\r\n      objArray,\r\n      key,\r\n      value;\r\n\r\n    // if it is already a jquery obj do not wrap it\r\n    form = form instanceof jQuery ? form : $(form);\r\n\r\n    // if there are more than 1 form\r\n    // or there is no dom form object, do nothing\r\n    if (form.length > 1 || !form[0]) {\r\n      return;\r\n    }\r\n\r\n    _.each(form.find('.required_hidden[data-date-mirror]'), function(item) {\r\n      var\r\n        $item = $(item),\r\n        _value = parseInt($item.val(), 10),\r\n        dateValue,\r\n        utcDateValue;\r\n\r\n      if (isNaN(_value)) {\r\n        return;\r\n      }\r\n      dateValue = new Date(_value);\r\n      utcDateValue = _value - (dateValue.getTimezoneOffset() * 60000);\r\n      $item.val(utcDateValue);\r\n    });\r\n\r\n    form.find('input.watermark').each(function() {\r\n      $(this).val('');\r\n    });\r\n\r\n    keyValues = _.map(form.serializeArray(), function(_value) {\r\n      if (_.isObject(_value) && _.isString(_value.value)) {\r\n        return (_value.name + '=' + _value.value).replace(/\\&/g, '\\\\u0026');\r\n      }\r\n    });\r\n    l = keyValues.length;\r\n\r\n    if (keyValues[0] === '') {\r\n      return;\r\n    }\r\n\r\n    for (i = 0; i < l; i += 1) {\r\n      objArray = keyValues[i].split('=');\r\n      key = objArray[0];\r\n      value = objArray[1].replace(/\\+/ig, ' ');\r\n      binder.set(key, value);\r\n    }\r\n  };\r\n\r\n\r\n  /*\\\r\n   * $B.validateForm\r\n   [ method ]\r\n   * Indicates weather a form passes validation\r\n   > Arguments\r\n   - form (object) jQuery dom form object\r\n   = (boolean) Returns true/false indicating weather the form passes validation\r\n   > Usage\r\n   | $B.validateForm($('#myForm'))\r\n  \\*/\r\n  $B.validateForm = function(form) {\r\n    return form.validate();\r\n  };\r\n\r\n  $B.prepareErrorTmplMsg = function(model, moduleId, e) {\r\n    var msg = ($B.app.literals.coreLiterals.error_tempalte + ' '),\r\n      modelUrl,\r\n      modelViewStateId;\r\n\r\n    if (moduleId) {\r\n      msg += ('#tmpl_' + moduleId + ', ');\r\n    }\r\n\r\n    if (model) {\r\n      modelUrl = model.url;\r\n      modelViewStateId = (_.isFunction(model.get) ? model.get('viewStateId') : model.viewStateId);\r\n\r\n      if (modelUrl && !_.isFunction(modelUrl)) {\r\n        msg += ('url: ' + modelUrl + ', ');\r\n      }\r\n      if (modelViewStateId) {\r\n        msg += ('viewStateId: ' + modelViewStateId + ', ');\r\n      }\r\n    }\r\n\r\n    return (msg += ($B.app.literals.coreLiterals.mensage_de_error + ' ' + e.message));\r\n  };\r\n\r\n  $B.tryGetTemplate = function(template, model, moduleId) {\r\n    var data,\r\n      resultErrorMsg = '';\r\n    try {\r\n      if (typeof template === 'string') {\r\n        data = template;\r\n      } else {\r\n        data = model ? template(model.toJSON()) : template();\r\n      }\r\n    } catch (e) {\r\n      resultErrorMsg = $B.prepareErrorTmplMsg(model, moduleId, e);\r\n      log().error(resultErrorMsg);\r\n      data = $B.errorTemplate('Error de templating', [resultErrorMsg]);\r\n      $B.tt.helper.trackErrorTmpl(model, moduleId, e);\r\n    }\r\n    return data;\r\n  };\r\n\r\n\r\n  /*\\\r\n   * $B.setCookie\r\n   [ method ]\r\n   * Sets a cookie with the given name\r\n   > Arguments\r\n   - name (string) name of the cookie to be created\r\n   - value (any) any value, could be object, string, array, etc\r\n   - expire (number) number in milliseconds the cookie will exist\r\n   > Usage\r\n   | $B.setCookie('cookieName', 'any value', 3600)\r\n  \\*/\r\n  $B.setCookie = function(name, value, expire) {\r\n    if (expire) {\r\n      var d = new Date();\r\n      d.setTime(d.getTime() + expire);\r\n      expire = '; expires=' + d.toGMTString();\r\n    } else {\r\n      expire = '';\r\n    }\r\n    document.cookie = name + '=' + value + expire + '; path=/';\r\n  };\r\n\r\n\r\n  /*\\\r\n   * $B.getCookie\r\n   [ method ]\r\n   * Gets a cookie with the given name\r\n   > Arguments\r\n   - name (string) name of the cookie\r\n   = (any) Returns cookie value\r\n   *\r\n   = (null) Returns null if there is no cookie with the given name\r\n   > Usage\r\n   | $B.getCookie('cookieName')\r\n  \\*/\r\n  $B.getCookie = function(name) {\r\n    var nameEQ = name + '=',\r\n      cookies = document.cookie.split(';'),\r\n      i,\r\n      l = cookies.length,\r\n      cookie;\r\n\r\n    for (i = 0; i < l; i += 1) {\r\n      cookie = cookies[i];\r\n      while (cookie.charAt(0) === ' ') {\r\n        cookie = cookie.substring(1, cookie.length);\r\n      }\r\n      if (cookie.indexOf(nameEQ) === 0) {\r\n        return cookie.substring(nameEQ.length, cookie.length);\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n\r\n\r\n  /*\\\r\n   * $B.deleteCookie\r\n   [ method ]\r\n   * Deletes a cookie with the given name\r\n   > Arguments\r\n   - name (string) name of the cookie to be deleted\r\n   > Usage\r\n   | $B.deleteCookie('cookieName')\r\n  \\*/\r\n  $B.deleteCookie = function(name) {\r\n    $B.setCookie(name, '', -1);\r\n  };\r\n\r\n\r\n  /*\\\r\n   * $B.getResourcePath\r\n   [ method ]\r\n   * Returns an object with resources paths\r\n   > Arguments\r\n   - view (string) id of the view to get its resources\r\n   - hasClientFlow (boolean) flag to look for clientFlow resources of the view\r\n   = Returns an object\r\n   > Usage\r\n   | $B.getResourcePath('posicion-global', false)\r\n   | // Returns\r\n   | {\r\n   |    id: \"posicion-global\",\r\n   |    script: \"/BBVANet/resources/posicion-global.mvc.js\",\r\n   |    tmpl: \"/BBVANet/resources/es_posicion-global.tmpl.html\"\r\n   | }\r\n  \\*/\r\n  $B.getResourcePath = function(view, hasClientFlow) {\r\n    var path = $B.staticPath + '/tmpl/',\r\n      fileName = view.replace(/\\_/g, '.'),\r\n      moduleId = fileName;\r\n\r\n    if (hasClientFlow) {\r\n      fileName = fileName + '.clientflow';\r\n    }\r\n\r\n    return {\r\n      id: moduleId,\r\n      script: path + fileName + '.mvc.js',\r\n      tmpl: path + $B.tmplPrefix + fileName + '.tmpl.html?' + $B.version,\r\n      flow: path + fileName + '.flow.json?' + $B.version\r\n    };\r\n  };\r\n\r\n\r\n  /*\\\r\n   * $B.getFucCoordinates\r\n   [ method ]\r\n   * Returns the coordinates according to the 'fuc' code\r\n   > Arguments\r\n   - code (string) The code \"fuc\"\r\n   - [callback] (function) the message to be displayed in the confirm dialog\r\n   > Usage\r\n   | $B.getFucCoordinates('000001909', function (data) {\r\n   | });\r\n  \\*/\r\n  $B.getFucCoordinates = function(code, callback) {\r\n    if (typeof code !== 'string') {\r\n      throw new TypeError($B.app.literals.coreLiterals.fuc_must_be_string);\r\n    }\r\n\r\n    var url = 'csapi?fuc=$fuc'.replace(/\\$fuc/, code),\r\n      resp,\r\n      xhr = new XMLHttpRequest();\r\n\r\n    xhr.onreadystatechange = function() {\r\n      if (xhr.readyState === 4) {\r\n        if (xhr.status === 200) {\r\n          resp = JSON.parse(xhr.responseText);\r\n        } else if (xhr.status === 500) {\r\n          resp = null;\r\n        }\r\n        if (typeof callback === 'function') {\r\n          callback(resp);\r\n        }\r\n      }\r\n    };\r\n    xhr.open('GET', url, true);\r\n    xhr.send(null);\r\n    // Return the XMLHttpRequest object just in case\r\n    // we would want to cancel the operation, etc...\r\n    return xhr;\r\n  };\r\n\r\n  $B.getGeolocationByOffice = function(office, callback) {\r\n    if (typeof office !== 'string') {\r\n      throw new TypeError($B.app.literals.coreLiterals.office_must_be_string);\r\n    }\r\n    $.ajax('csapi?oficina=' + office, {\r\n      data: {},\r\n      error: function() {\r\n        $B.errorGenerico('ERROR', $B.app.literals.coreLiterals.hubo_un_error);\r\n      },\r\n      success: function(data) {\r\n        if (callback && typeof callback === 'function') {\r\n          callback(data);\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n\r\n  /*\\\r\n   * $B.showConfirm\r\n   [ method ]\r\n   * Shows a confirm dialog when closing the 'application'\r\n   * given the passed arguments\r\n   > Arguments\r\n   - value (boolean) flag indicating if we should or shouldn't show this confirm dialog\r\n   - message (string) the message to be displayed in the confirm dialog\r\n   > Usage\r\n   | $B.showConfirm(true, 'Are you sure you want to quit?')\r\n  \\*/\r\n  $B.showConfirm = function(value, message) {\r\n    var callback = function() {\r\n      if (value) {\r\n        return message;\r\n      }\r\n      return null;\r\n\r\n    };\r\n    window.onbeforeunload = callback;\r\n  };\r\n  // subscribe to the 'showConfirm' event\r\n  // and bind it to $B.showConfirm handler\r\n  // publish with\r\n  // $.publish('showConfirm', true, 'Are you sure?');\r\n  $.subscribe('showConfirm', $B.showConfirm);\r\n\r\n  /*\\\r\n   * Global $.ajaxError handler\r\n  \\*/\r\n  $('body').ajaxError(function(e, jqxhr, settings, exception) {\r\n    var msg;\r\n    if (settings.url !== $B.dynPath + 'viewClientLog') {\r\n      msg = '\\nError [AJAX]:\\n' +\r\n        'Request Url: ' + settings.url + ' \\n' +\r\n        'Error message: ' + exception + ' \\n' +\r\n        'From: ' + window.location.href + ' \\n' +\r\n        'XHR: ' + JSON.stringify(jqxhr);\r\n\r\n      log().error(msg);\r\n    }\r\n  });\r\n\r\n  /*\\\r\n   * $B.errorTemplate\r\n   [ method ]\r\n   * Returns an HTML string used for error templates\r\n   > Arguments\r\n   - title (string) Title for this error\r\n   - description (string) Description for this error\r\n   - showButton (boolean) Flag indicating whether to display a button (to close this error 'div')\r\n   - buttonDataAttribute (string) The value of the 'data' attriute for the button\r\n   > Usage\r\n   | $B.errorTemplate('Error 500', 'Something went wrong', false)\r\n  \\*/\r\n  $B.errorTemplate = function(title, description, showButton, buttonDataAttribute, viewCid) {\r\n    var template,\r\n      $template;\r\n    if (title === 'ERROR_SERVICIO' || title === 'ERROR_VALIDACION') {\r\n      title = $B.app.literals.coreLiterals.error;\r\n    }\r\n    template = _.c_v07_mensajes_errorAplicacion({\r\n      titulo: title || $B.app.literals.coreLiterals.error,\r\n      descripcion: description || $B.app.literals.coreLiterals.error_inesperado,\r\n      exception: showButton || false,\r\n      viewCid: viewCid || null,\r\n      dataAttr: buttonDataAttribute || null,\r\n      showButton: showButton || false\r\n    });\r\n\r\n    template = '<div>' + template + '</div>';\r\n\r\n    $template = $(template);\r\n\r\n    return $template.html();\r\n  };\r\n\r\n\r\n  $B.validationErrorTemplate = function(data) {\r\n    // si no llega array de descripciones, lo eliminamos para mostrar el mensaje por defecto\r\n    if (_.isUndefined(data.descriptions) || _.isNull(data.descriptions)) {\r\n      delete data.descriptions;\r\n    }\r\n    return _.c_mensajes_alerta_servervalidation(data);\r\n  };\r\n\r\n  $B.warningTemplate = function(data) {\r\n    return _.c_mensajes_alerta_aviso(data);\r\n  };\r\n\r\n  /*\\\r\n   * $B.reloadSpi\r\n   [ method ]\r\n   * Reload the spi\r\n   > Arguments\r\n   > Usage\r\n   | $B.reloadSpi()\r\n  \\*/\r\n  $B.reloadSpi = function() {\r\n    var hash = document.location.hash;\r\n    if (hash.length > 1) {\r\n      window.location.href = $B.reloadAppUrl + '=' + hash.substring(1) + hash;\r\n    } else {\r\n      window.location.href = $B.reloadAppUrl;\r\n    }\r\n  };\r\n\r\n  /*\\\r\n   * $B.showLoading\r\n   [ method ]\r\n   * Returns an HTML string used for 'loading messages'\r\n   > Arguments\r\n   - text (string) Text of the loading message (optional, defaults to 'Cargando')\r\n   > Usage\r\n   | $B.showLoading('Cerrando')\r\n  \\*/\r\n  $B.showLoading = function(text) {\r\n    return _.c_v06_mensajes_cargando({\r\n      text: text || $B.app.literals.cargando,\r\n      image: 'preload_general_mini.gif'\r\n    });\r\n  };\r\n\r\n  // preparativos antes de iniciar la navegacion\r\n  $B.prepareToTryToNavigateTo = function() {\r\n    /*$B.ui.fixedHeader.goTop();*/\r\n    $B.showNavigateLoading();\r\n    $B.resetBuscador();\r\n    // Se limpia el cacheo de colores de graficos\r\n    $B.ui.GraphicChartsColors = {};\r\n  };\r\n\r\n  // muestra v.modal de loading\r\n  $B.showNavigateLoading = function(loadingClass, loadingOverlayClass) {\r\n    $B.ui.navigationLoading.show({\r\n      loadingClass: (loadingClass || 'loading-navigation'),\r\n      overlayClass: (loadingOverlayClass || 'ui-widget-overlay-mensaje-cargando')\r\n    });\r\n    if (!$B.initialLoading && ($B.errorInInitialStaticLoad || $B.initialStaticLoad)) {\r\n      $B.errorInInitialStaticLoad = false;\r\n      $B.initialStaticLoad = false;\r\n    }\r\n  };\r\n\r\n  // oculta v.modal de loading\r\n  $B.hideLoading = function(loadingClass) {\r\n    $B.ui.navigationLoading.hide({\r\n      loadingClass: (loadingClass || 'loading-navigation')\r\n    });\r\n    $B.initialLoading = false;\r\n  };\r\n\r\n  // limpia posibles valores del buscador\r\n  $B.resetBuscador = function() {\r\n    $('#ph_menu').removeClass('buscadorDesplegado').find('#buscadorGeneral input[type=\"text\"]').val('');\r\n  };\r\n\r\n  // se encarga de comprobar que se han ocultado las modales, ejecutar preparativos e invocar al callback pasado\r\n  $B.checkModalClosedAndExecNavigation = function(data) {\r\n    var callbackFn,\r\n      callbackArgs,\r\n      callbackContext,\r\n      checker,\r\n      invalidDataParameters = (function() {\r\n        return !data || (!data.callback && (!_.isFunction(data.callback) || !_.isFunction(data.context[data.callback])));\r\n      }());\r\n\r\n    if (invalidDataParameters) {\r\n      return;\r\n    }\r\n\r\n    callbackContext = data.context;\r\n    callbackFn = (_.isObject(callbackContext) && _.isString(data.callback)) ? callbackContext[data.callback] : data.callback;\r\n    callbackArgs = data.params;\r\n\r\n    checker = function() {\r\n      if (!$('.ui-widget-overlay:visible, [role=dialog]:visible')[0]) {\r\n        $B.prepareToTryToNavigateTo();\r\n        callbackFn.apply(null, callbackArgs);\r\n      } else {\r\n        $B.hideLoading();\r\n        setTimeout(function() {\r\n          checker();\r\n        }, 0);\r\n      }\r\n    };\r\n    checker();\r\n  };\r\n\r\n  // Subscribe to the 'updateUrl' event\r\n  $.subscribe('updateUrl', function(e, fragment) {\r\n    if (fragment) {\r\n      Backbone.history.navigate(fragment, {\r\n        trigger: false\r\n      });\r\n    }\r\n  });\r\n\r\n\r\n  /*\\\r\n   * $B.subscribes\r\n   [ method ]\r\n   * Anade suscripciones a un objeto\r\n   > Arguments\r\n   - viewSubscribes (object) objeto que, organizado como events, nos indica el evento y la funcion asociada, como Function o String (ej: { 'evento' : 'nombreFuncionVista' })\r\n   - view (object) la vista que contiene la funcion asociada al evento (inidicado en el objeto anterior)\r\n   > Usage\r\n   | $B.subscribes(this.subscribes, this);\r\n  \\*/\r\n  $B.subscribes = function(viewSubscribes, view) {\r\n    var event = null;\r\n    for (event in viewSubscribes) {\r\n      if (viewSubscribes.hasOwnProperty(event)) {\r\n        if (_.isFunction(viewSubscribes[event])) {\r\n          $.subscribe(event, _.bind(viewSubscribes[event], view));\r\n        } else if (_.isFunction(view[viewSubscribes[event]])) {\r\n          $.subscribe(event, view[viewSubscribes[event]]);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  /*\\\r\n   * $B.checkViewOptions\r\n   [ method ]\r\n   * Checks the options object of a given Backbone.View to make\r\n   * sure some of the default options can't be over written\r\n   > Arguments\r\n   - options (object) An object (hash) reprensenting a Backbone.View's options hash\r\n   > Usage\r\n   | $B.checkViewOptions(someView.options);\r\n  \\*/\r\n  $B.checkViewOptions = function(options) {\r\n    var excludes = ['initialize', 'render', 'loadPage', 'pageLoaded'],\r\n      i,\r\n      l = excludes.length,\r\n      option = null;\r\n    if (options && typeof options === 'object' && !_.isArray(options)) {\r\n      for (option in options) {\r\n        if (options.hasOwnProperty(option)) {\r\n          for (i = 0; i < l; i += 1) {\r\n            if (option === excludes[i]) {\r\n              option = null;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return options;\r\n    }\r\n  };\r\n\r\n\r\n  /*\\\r\n   * $B.checkModelAttributes\r\n   [ method ]\r\n   * Checks if attributes are present in a given model's attribute\r\n   > Arguments\r\n   - attributes (array) An array of attribute names to check against\r\n   - model (Backbone.Model) The Backbone.Model to check against\r\n   > Usage\r\n   | $B.checkModelAttributes(['name', 'email'], someModel);\r\n  \\*/\r\n  $B.checkModelAttributes = function(attributes, model) {\r\n    if (_.isArray(attributes)) {\r\n      var i, l = attributes.length,\r\n        attr;\r\n      for (i = 0; i < l; i += 1) {\r\n        attr = attributes[i];\r\n        if (!model.get(attr)) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n  };\r\n\r\n  /*\\\r\n   * Global scroll handler\r\n  \\*/\r\n  $(window).scroll(function(ev) {\r\n    $.publish('scroll:window', [ev]);\r\n  });\r\n\r\n\r\n\r\n  $B.signature = {\r\n\r\n    viewStates: [\r\n      'mostrarFormularioClaveOperaciones',\r\n      'mostrarFormularioClaveOTP',\r\n      'mostrarFormularioClaveSMS',\r\n      'mostrarFormularioToken',\r\n      'mostrarFormularioClavePasscode',\r\n      'mostrarAppletFirma'\r\n    ],\r\n\r\n    eventsId: [\r\n      'comprobarClaveOTP',\r\n      'comprobarClaveSMS',\r\n      'comprobarToken',\r\n      'comprobarClavePasscode',\r\n      'validarDesafioFirmado'\r\n    ],\r\n\r\n    checkEventId: function(eventIdToCheck) {\r\n      return _.find(this.eventsId, function(eventId) {\r\n        return eventId === eventIdToCheck;\r\n      });\r\n    },\r\n\r\n    checkViewStateId: function(viewStateToCheck) {\r\n      return _.find(this.viewStates, function(viewState) {\r\n        return viewState === viewStateToCheck;\r\n      });\r\n    },\r\n    evaluarMetodoFirmaSegundoNivel: function(view) {\r\n      // es verdadero cuando hay mas de un nivel de firma\r\n      // y ninguno de ellos es dnie\r\n      if (view.methods.length > 1) {\r\n        return true;\r\n      }\r\n\r\n      // tb es verdadero si hay mas de un metodo de firma de segundo nivel\r\n      if (view.methods2Lv.length > 1) {\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    },\r\n\r\n    setEventId: function(view, doReturn) {\r\n      var eventId;\r\n      this.setSimpleMethods(view);\r\n\r\n      if (view.model.get('mostrarInformacionInterviniente') && !view.methods[0]) {\r\n        eventId = 'evaluarMetodoAccesoOtroInterviniente';\r\n        //      } else if (this.evaluarMetodoFirmaSegundoNivel(view)) {\r\n        //        eventId = 'evaluarMetodoFirmaSegundoNivelSeleccionado';\r\n      } else {\r\n        switch (view.methods[0]) {\r\n          case 'DNI_ELECTRONICO':\r\n            eventId = 'generarDesafioDNIe';\r\n            break;\r\n          case 'CLAVE_OPERACIONES':\r\n            eventId = 'comprobarClaveOperaciones';\r\n            break;\r\n          case 'CLAVE_ACCESO':\r\n            eventId = 'comprobarClaveAcceso';\r\n            break;\r\n          case 'SOLO_OTP':\r\n            eventId = 'comprobarClaveOTP';\r\n            break;\r\n          case 'SOLO_OTP_SEGUNDO_FACTOR':\r\n            eventId = view.model.get('evolutivoEliminacionClaveOperaciones') ? 'comprobarClaveOTP' : 'comprobarClaveSMS';\r\n            break;\r\n        }\r\n      }\r\n      if (!doReturn) {\r\n        // seteamos el data-eventid del form con el apropiado\r\n        view.$('form').data('eventid', eventId).attr('data-eventid', eventId);\r\n      } else {\r\n        return eventId;\r\n      }\r\n    },\r\n\r\n    clearMethods: function(view) {\r\n      delete view.methods;\r\n    },\r\n\r\n    setSimpleMethods: function(view) {\r\n      if (!view.methods) {\r\n        view.methods = [];\r\n      }\r\n      view.methods = (function() {\r\n        if (view.methods.length > 0 && !view.model.get('mostrarInformacionInterviniente')) {\r\n          return view.methods;\r\n        }\r\n        return _.pluck(view.model.get('metodosFirmaPrimerNivel'), 'value');\r\n      }());\r\n\r\n      //es necesario incluir los metodos de segundo nivel para saber si hay que llamar a evaluarMetodoFirmaSegundoNivel\r\n      if (!view.methods2Lv) {\r\n        view.methods2Lv = [];\r\n      }\r\n      view.methods2Lv = (view.methods2Lv.length > 0) ? view.methods2Lv : _.pluck(view.model.get('metodosFirmaSegundoNivel'), 'value');\r\n    },\r\n\r\n    dom_toggleDisableState: function(ev) {\r\n      ev.stopPropagation();\r\n      $B.ui.changevisibility(ev);\r\n      $B.ui.dialogCenter();\r\n    },\r\n\r\n    setApperance: function(view) {\r\n      var dataAttr;\r\n      if ($B.app.SingleStepView) {\r\n        dataAttr = 'claves-' + (view instanceof $B.app.SingleStepView ? 'pastilla' : 'pasos');\r\n      } else {\r\n        dataAttr = 'claves-pasos';\r\n      }\r\n      view.$el.attr('data-' + dataAttr, true);\r\n      view.$el.data(dataAttr, true);\r\n    },\r\n\r\n    checkSecondLevelMethodsAssociated: function(view, $associatedDomMethod) {\r\n      var secondLevelMethods = view.model.get('metodosFirmaSegundoNivel');\r\n      if ($associatedDomMethod[0] && (secondLevelMethods !== null && secondLevelMethods.length <= 1)) {\r\n        $associatedDomMethod.find('input[name=indiceMetodoFirmaSegundoNivelSeleccionado]').click();\r\n      }\r\n    },\r\n\r\n    dom_prepareDomMethods: function(view) {\r\n      this.setSimpleMethods(view);\r\n\r\n      if (view.methods.length) {\r\n        // Si hay 3 metodos de firma de segundo nivel, se pone la clase tresBotones al contenedor\r\n        var listSecondLevelMethods = view.model.get('metodosFirmaSegundoNivel');\r\n        if (listSecondLevelMethods !== null && listSecondLevelMethods.length === 3) {\r\n          $('.jsFirmasSegundoNivel').addClass('tresBotones');\r\n        }\r\n      } else if (!view.model.get('mostrarInformacionInterviniente')) {\r\n        view.$('.contenedorPaso').html($B.errorTemplate('ERROR', $B.app.literals.error_no_metodos_firma, true, null, view.options.parentViewCid));\r\n        $B.utils.aria.alertDialog(view.$('.contenedorPaso'));\r\n      }\r\n\r\n      if ($('.c-botones-seleccion:visible').length) {\r\n        $B.utils.aria.switcher({\r\n          element: $('.c-botones-seleccion:visible'),\r\n          tabs: 'li',\r\n          tabsChildren: 'label',\r\n          selected: 'label.checked',\r\n          id: 'switcher-botones-seleccion'\r\n        });\r\n      }\r\n    },\r\n\r\n    dom_initStatus: function(view) {\r\n      this.setSimpleMethods(view);\r\n\r\n      // Si hay menos de 2 metodos de firma de segundo nivel se oculta\r\n      var listSecondLevelMethods = view.model.get('metodosFirmaSegundoNivel');\r\n      if (listSecondLevelMethods && listSecondLevelMethods.length < 2) {\r\n        $('.jsFirmasSegundoNivel .c-botones-seleccion').hide();\r\n      }\r\n    }\r\n  };\r\n\r\n  //OBJETO DE FIRMA CON DNIe\r\n  $B.DNIe = {\r\n\r\n    DNIeTimeout: 2000,\r\n\r\n    _counterAppletReady: 0,\r\n\r\n    _secondsTryingCheckingAppletReady: 60,\r\n\r\n    _checkingApplet: false,\r\n\r\n    alreadyLaunchedApplet: false,\r\n\r\n    getApplet: function() {\r\n      return this.view.$('#idApplet')[0] || {};\r\n    },\r\n\r\n    appletInitialize: function(view) {\r\n      this._setViewParameters(view);\r\n      this._counterAppletReady = 0;\r\n      this._checkAppletReady();\r\n    },\r\n\r\n    launchApplet: function() {\r\n      if (this.alreadyLaunchedApplet === false) {\r\n        (this.getApplet()).launch();\r\n        this.alreadyLaunchedApplet = true;\r\n        this.appletCheckDone();\r\n      }\r\n    },\r\n\r\n    appletCheckDone: function() {\r\n      var\r\n        self = this,\r\n        applet = self.getApplet(),\r\n        dseventdone = (_.isObject(applet) && applet.dseventdone());\r\n\r\n      if (dseventdone) {\r\n        self._checkingApplet = false;\r\n        self._proccessResponse();\r\n      } else {\r\n        self._checkingApplet = true;\r\n        setTimeout(function() {\r\n          self.appletCheckDone();\r\n        }, self.DNIeTimeout);\r\n      }\r\n    },\r\n\r\n    appletCorrect: function() {\r\n      var self = this;\r\n      this.alreadyLaunchedApplet = false;\r\n      self.viewModel.save({\r\n        desafio: self.getApplet().output(),\r\n        userCertificate: self.getApplet().getCertificate(),\r\n        _eventId: 'validarDesafioFirmado'\r\n      }, {\r\n        error: function(model, resp) {\r\n          var jsonResp = resp.operacionResultado ? resp : $.parseJSON(resp.responseText);\r\n          self._showServerError(jsonResp.operacionResultado, jsonResp.operacionMensaje);\r\n        },\r\n        success: function(model, resp) {\r\n          if (_.isFunction(self.view.DNIe_customSuccess)) {\r\n            self.view.DNIe_customSuccess(model, resp);\r\n          } else {\r\n            $(self.view.$('[data-error-applet]')[0] || self.view.$('.c-mensajes-alerta_R2')[0]).remove();\r\n            self.view.model.set(model.attributes);\r\n            if (_.isFunction(self.view.processDNIeSignedCorrectly)) {\r\n              self.view.processDNIeSignedCorrectly();\r\n            }\r\n          }\r\n        },\r\n        validationError: function(model, resp) {\r\n          self._showServerError(resp.operacionResultado, resp.operacionMensaje);\r\n        }\r\n      });\r\n    },\r\n\r\n    appletError: function() {\r\n      var errorTitle,\r\n        errorMsg,\r\n        self = this;\r\n\r\n      try {\r\n        errorMsg = $B.app.literals.appletDnie[(self.getApplet()).getError()];\r\n        errorTitle = 'ERROR';\r\n      } catch (e) {\r\n        errorMsg = $B.app.literals.appletDnie.updateJava;\r\n        errorTitle = $B.app.literals.appletDnie.aviso;\r\n      }\r\n\r\n      self.alreadyLaunchedApplet = false;\r\n      self._showAppletError(errorTitle, errorMsg);\r\n    },\r\n\r\n    _checkAppletReady: function() {\r\n      var self = this;\r\n      setTimeout(function() {\r\n        function isAppletReady() {\r\n          var dseventready = function() {\r\n            try {\r\n              return (self.getApplet()).dseventready();\r\n            } catch (e) {\r\n              return false;\r\n            }\r\n          };\r\n          return dseventready();\r\n        }\r\n\r\n        function isOnTime() {\r\n          return (self._counterAppletReady < (self._secondsTryingCheckingAppletReady / 2));\r\n        }\r\n\r\n        self._counterAppletReady += 1;\r\n\r\n        try {\r\n          if (isAppletReady()) {\r\n            self.launchApplet();\r\n          } else if (isOnTime()) {\r\n            self._checkAppletReady();\r\n          } else {\r\n            self.appletError();\r\n          }\r\n        } catch (e) {\r\n          if (isAppletReady()) {\r\n            self._checkAppletReady();\r\n          } else if (!self.alreadyLaunchedApplet && isOnTime()) {\r\n            self.appletError();\r\n          }\r\n        }\r\n      }, self.DNIeTimeout);\r\n    },\r\n\r\n    _proccessResponse: function() {\r\n      var appletResult = ((this.getApplet()).getError() || false);\r\n\r\n      if (appletResult === 'ERR00') {\r\n        this.appletCorrect();\r\n      } else {\r\n        this.appletError();\r\n      }\r\n    },\r\n\r\n    _showServerError: function(title, description) {\r\n      var $wrapper = $(this.view.$('.c-form-claveOperacionesFM')[0] || this.view.$('.contenedorPaso')[0]);\r\n      $wrapper\r\n        .children('*:not(.btnCierre)')\r\n        .remove();\r\n\r\n      $wrapper.append($B.errorTemplate(title, description));\r\n    },\r\n\r\n    _showAppletError: function(title, description) {\r\n      var self = this,\r\n        $wrapper = $(this.view.$('.jsFirmasSegundoNivel')[0] || this.view.$('.contenedorPaso')[0]),\r\n        $containerErrorAndRetryButton = $($wrapper.find('[data-error-applet]')[0] || $wrapper.append('<div data-error-applet class=\"contenedorPaso\"></div>').find('[data-error-applet]')[0]),\r\n        content = ($B.validationErrorTemplate({\r\n          title: title,\r\n          descriptions: [description]\r\n        }) + _.template($('#tmpl_reintentarAppletDNIe').html(), self.viewModel.toJSON()));\r\n\r\n      // ocultamos las capas sobrantes\r\n      self._toggleVisibilityOnErrorApplet('hide');\r\n      // incluimos el mensaje de error y el boton de reintentar\r\n      $wrapper.before(\r\n        $containerErrorAndRetryButton.html(content)\r\n      );\r\n\r\n      // bindeamos el click en el boton reintentar para que reinicie el applet\r\n      self.view.$('[data-reintentar-firma-dnie]').on('click', function() {\r\n        // destruimos tanto capa de error como boton\r\n        $containerErrorAndRetryButton.remove();\r\n        // mostramos las capas necesarias\r\n        self._toggleVisibilityOnErrorApplet('show');\r\n        // iniciamos el applet nuevamente\r\n        self._counterAppletReady = 0;\r\n        setTimeout(function() {\r\n          self._checkAppletReady();\r\n        }, self.DNIeTimeout);\r\n      });\r\n    },\r\n\r\n    _toggleVisibilityOnErrorApplet: function(type) {\r\n      var self = this,\r\n        $loadingAndInfoRetryLayers = self.$loadingAndInfoRetryLayers || self.view.$('[data-firmadnie-loading], .moduloFirma.dnie, [data-applet]'),\r\n        $wrapperMultipleOptionFirsLevel = self.$wrapperMultipleOptionFirsLevel || self.view.$('.moduloFirma.dnie').closest('.jsFirmasSegundoNivel'),\r\n        $applet = $loadingAndInfoRetryLayers.find('applet');\r\n\r\n      self.appletContainer = self.appletContainer || $applet.parent();\r\n      self.appletTag = self.appletTag || $applet;\r\n\r\n      if (!type) {\r\n        return;\r\n      }\r\n      if (type === 'hide') {\r\n        $loadingAndInfoRetryLayers.hide();\r\n        $applet.remove();\r\n        if ($wrapperMultipleOptionFirsLevel[0]) {\r\n          $wrapperMultipleOptionFirsLevel.hide();\r\n        }\r\n      } else if (type === 'show') {\r\n        try {\r\n          $loadingAndInfoRetryLayers.show();\r\n          self.appletContainer.html(self.appletTag);\r\n          if ($wrapperMultipleOptionFirsLevel[0]) {\r\n            $wrapperMultipleOptionFirsLevel.show();\r\n          }\r\n        } catch (e) {\r\n          self.appletError();\r\n        }\r\n      }\r\n    },\r\n\r\n    _setViewParameters: function(view) {\r\n      this.view = view;\r\n      this.viewModel = _.extend({}, view.model);\r\n    }\r\n  };\r\n\r\n\r\n  //Objeto para inyectar el applet del DNIe en cualquier vista con un contenedor para alojar caulquier posible error\r\n  $B.DNIeCustom = (function(DNIeObj) {\r\n    var overrideMethods,\r\n      customMethods,\r\n      selectorWrapperError = '[data-dniemodule-error]',\r\n      selectorWrapperApplet = '[data-dniemodule-container]';\r\n\r\n    if (!_.isObject(DNIeObj)) {\r\n      return;\r\n    }\r\n\r\n    overrideMethods = {\r\n      _showAppletError: function(title, description) {\r\n        var self = this,\r\n          $wrapperError = $(selectorWrapperError),\r\n          $wrapperApplet = $(selectorWrapperApplet),\r\n          content = ($B.validationErrorTemplate({\r\n            title: title,\r\n            descriptions: [description]\r\n          }) + _.template($('#tmpl_reintentarAppletDNIe').html(), self.viewModel.toJSON()));\r\n\r\n        // ocultamos las capas sobrantes\r\n        $wrapperApplet.hide();\r\n\r\n        // incluimos el mensaje de error y el boton de reintentar\r\n        $wrapperError.html(content);\r\n\r\n        // bindeamos el click en el boton reintentar para que reinicie el applet\r\n        self.view.$('[data-reintentar-firma-dnie]')\r\n          .off('click')\r\n          .on('click', function() {\r\n            // destruimos tanto capa de error como boton\r\n            $wrapperError.empty();\r\n            // mostramos las capas necesarias\r\n            // renderizar de nuevo el applet\r\n            $wrapperApplet.show();\r\n            // iniciamos el applet nuevamente\r\n            self._counterAppletReady = 0;\r\n            self._checkAppletReady();\r\n          });\r\n      }\r\n\r\n    };\r\n\r\n    customMethods = {\r\n      init: function(view) {\r\n        var self = this,\r\n          content,\r\n          params,\r\n          $wrapper;\r\n\r\n        self.$el = $wrapper = view.$(selectorWrapperApplet);\r\n\r\n        content = _.template($('#tmpl_pantalla_intermedia_applet_dnie').html());\r\n\r\n        $wrapper.html(content);\r\n\r\n        view.$('[data-firma-btnenviar]')\r\n          .off('click')\r\n          .on('click', function() {\r\n            params = {\r\n              keyStoreCertificados: view.model.get('keyStoreCertificados'),\r\n              desafio: view.model.get('desafio'),\r\n              mostrarInformacionInterviniente: false\r\n            };\r\n\r\n            $wrapper.html(_.tmpl('#tmpl_mostrarAppletFirma', params));\r\n            self.appletInitialize(view);\r\n          });\r\n      }\r\n    };\r\n\r\n    return _.extend({}, DNIeObj, overrideMethods, customMethods);\r\n\r\n  }($B.DNIe));\r\n\r\n\r\n  $B.checkContentHeightDialogs = {\r\n    ultimoHeight: 0,\r\n\r\n    isActiveInterval: false,\r\n\r\n    frequency: 100,\r\n\r\n    domModalSelector: '.contenidoModal:visible',\r\n\r\n    init: function() {\r\n      var modalInterval,\r\n        self = this,\r\n        checkModalHeight,\r\n        removeInterval,\r\n        posScroll,\r\n        initInterval;\r\n\r\n      if (self.isActiveInterval) {\r\n        return false;\r\n      }\r\n\r\n      initInterval = function() {\r\n        modalInterval = setInterval(checkModalHeight, self.frequency);\r\n        if ($B.appConfig.enableTabletFeatures && $B.capabilities.touch) {\r\n          posScroll = $('body').scrollTop();\r\n          $('body').scrollTop(0);\r\n          $('body >.c-estructural-pie').hide();\r\n          $('body >.container_24').hide();\r\n        }\r\n        return true;\r\n      };\r\n\r\n      removeInterval = function() {\r\n        self.ultimoHeight = 0;\r\n        clearInterval(modalInterval);\r\n        if ($B.appConfig.enableTabletFeatures && $B.capabilities.touch) {\r\n          $('body >.c-estructural-pie').show();\r\n          $('body >.container_24').show();\r\n          $('body').scrollTop(posScroll);\r\n        }\r\n        return false;\r\n      };\r\n\r\n      checkModalHeight = function() {\r\n        if ($(self.domModalSelector)[0]) {\r\n          var heightActual = (function() {\r\n            return $('.scrollable.scrollableModal').children().filter(function(i, item) {\r\n              item = $(item);\r\n              if (item.is(':visible') && item.height() > 0) {\r\n                return item;\r\n              }\r\n            }).height();\r\n          }());\r\n          if (heightActual !== self.ultimoHeight || !$B.ui.dialogHasSecureHeight()) {\r\n            $B.ui.dialogCenter();\r\n          }\r\n          self.ultimoHeight = heightActual;\r\n        } else {\r\n          self.isActiveInterval = removeInterval();\r\n        }\r\n      };\r\n\r\n      if ($(self.domModalSelector)[0]) {\r\n        self.isActiveInterval = initInterval();\r\n      } else {\r\n        self.isActiveInterval = removeInterval();\r\n      }\r\n\r\n    }\r\n  };\r\n\r\n  $B.switchOperativa = (function() {\r\n    var self = this,\r\n      ocultarPaso = function($el) {\r\n        var $contenedorOperativas = $el.closest('div[data-switchOperativa]'),\r\n          $modal = $el.closest('.ui-dialog');\r\n        // restaurar el titulo\r\n        $modal.find('.headerModal h1').text($contenedorOperativas.attr('data-tituloAnterior'));\r\n        // mostrar el contenido anterior y eliminar el abierto\r\n        $contenedorOperativas.parent().children().show();\r\n        $contenedorOperativas.remove();\r\n        // volver a mostrar el boton de cerrar original\r\n        $modal.find('.cerrarModal').eq(1).remove();\r\n        $modal.find('.cerrarModal').eq(0).show();\r\n      },\r\n      duplicarBotonCerrar = function($el) {\r\n        var $modal = $el.closest('.ui-dialog'),\r\n          $botonCerrar = $modal.find('.cerrarModal'),\r\n          $newBotonCerrar;\r\n        // duplicar el boton de cerrar y ocultarlo\r\n        $botonCerrar.parent().append($botonCerrar.clone());\r\n        $botonCerrar.hide();\r\n        // quitarle el atributo de cerrar y ponerle un atributo para referenciarlo desde el dom\r\n        $newBotonCerrar = $modal.find('.cerrarModal').eq(1);\r\n        $newBotonCerrar.removeAttr('data-dialog-close');\r\n        $newBotonCerrar.attr('data-switchOperativa', 'si');\r\n        // poner eventos de click\r\n        $newBotonCerrar.off('click');\r\n        $newBotonCerrar.on('click', function() {\r\n          ocultarPaso($el.find('[data-switchOperativa=si]'));\r\n        });\r\n      },\r\n      mostrarPaso = function(selectorContenedor, url) {\r\n        var $el, tituloAnterior, capaAutoloadHTML, $trower;\r\n        // contenedor donde se realiza el cambio\r\n        $el = $(selectorContenedor);\r\n        // guardar el tirulo de la modal ya que se modifica desde la nueva operativa abierta\r\n        tituloAnterior = $(selectorContenedor).closest('.ui-dialog').find('.headerModal h1').text();\r\n        // crear un nuevo contenedor para la nueva operativa\r\n        // data-switchOperativa para poder buscar via dom la capa\r\n        //  data-tituloAnterior para gaurdar el titulo que tenia la modal antes del cambio\r\n        capaAutoloadHTML = $('<div>', {\r\n          'data-autoload': url,\r\n          'data-switchOperativa': 'si',\r\n          'data-tituloAnterior': tituloAnterior\r\n        });\r\n        //ocultar el contenido del paso\r\n        $el.children().hide();\r\n        // crear una capa con el div autoload\r\n        $el.append(capaAutoloadHTML);\r\n        $trower = jQuery('div[data-autoload=\"' + url + '\"]');\r\n        $B.app.AppView.prototype.prepareAutoload($trower);\r\n        // como el bootn de cerrar cierra la modal pongo un duplicado para intercambiar los contenidos\r\n        duplicarBotonCerrar($el, capaAutoloadHTML);\r\n      };\r\n\r\n    self.switchOperativa = function(e, objParam) {\r\n      if (objParam.selectorContenedor && objParam.url) {\r\n        mostrarPaso(objParam.selectorContenedor, objParam.url);\r\n      } else if (objParam.$el) {\r\n        ocultarPaso(objParam.$el);\r\n      }\r\n    };\r\n    self.isSwitchOperativa = function($el) {\r\n      if ($el.closest('div[data-switchOperativa]').length > 0) {\r\n        return true;\r\n      }\r\n      return false;\r\n    };\r\n    $.subscribe('switchOperativa', self.switchOperativa);\r\n    return self;\r\n  }());\r\n\r\n  /* recubrimiento para intervalos */\r\n  (function() {\r\n    function isInDom(el) {\r\n      return $(el).closest('body')[0];\r\n    }\r\n    $B.setLinkedInterval = function(el, interval, fn) {\r\n      var wrapper, intervalId, heartBeat, heartBeatId, applyCallback, callback;\r\n      if (!fn) {\r\n        return;\r\n      }\r\n      applyCallback = function() {\r\n        if (_.isObject(fn)) {\r\n          callback = fn.context[fn.fn].apply(fn.context);\r\n        } else if (_.isFunction(fn)) {\r\n          callback = fn;\r\n        }\r\n      };\r\n      heartBeat = function() {\r\n        if (!isInDom(el)) {\r\n          clearInterval(intervalId);\r\n          clearInterval(heartBeatId);\r\n        }\r\n      };\r\n      wrapper = function() {\r\n        if (isInDom(el)) {\r\n          applyCallback();\r\n        } else {\r\n          clearInterval(intervalId);\r\n          clearInterval(heartBeatId);\r\n        }\r\n      };\r\n      intervalId = setInterval(wrapper, interval);\r\n      heartBeatId = setInterval(heartBeat, 1000);\r\n      return intervalId;\r\n    };\r\n  }());\r\n\r\n\r\n  $B.checkAndPreparePublicRoute = function(route) {\r\n    if ($B.isPublic) {\r\n      return (route.split($B.publicPath)[1] ? route : ($B.publicPath + route));\r\n    }\r\n    return route;\r\n  };\r\n\r\n  $B.getUrlPatternFromModelUrl = function(urlModel) {\r\n    var\r\n      urlPatternResult = urlModel,\r\n      processedUrlModel = $B.checkAndPreparePublicRoute(urlModel.split($B.dynPath)[1]),\r\n      replaceParams = function(urlRegExp) {\r\n        var\r\n          params = urlRegExp.exec(processedUrlModel),\r\n          url = params[0];\r\n\r\n        _.each(params, function(param) {\r\n          if (url !== param) {\r\n            url = url.replace(('/' + param), '/*');\r\n          }\r\n        });\r\n\r\n        return url;\r\n      },\r\n      routeExistRegExp = $B.router.routeExists(processedUrlModel);\r\n\r\n    if (routeExistRegExp) {\r\n      urlPatternResult = replaceParams(routeExistRegExp);\r\n    }\r\n\r\n    return urlPatternResult;\r\n  };\r\n\r\n\r\n  /**\r\n   * Obtiene las templates mergeadas adicionales en modo comprimido si $B.mergedTmpl esta definido\r\n   * @param {Boolean} async True para instancia XHR asincrona. Default False\r\n   */\r\n  $B.getMergedTmpl = (function() {\r\n    var tries = 0;\r\n    return function getMergedTmpl(async) {\r\n      if ($B.mergedTmpl) {\r\n        // performs a sync XHR (not AJAX)\r\n        $.ajax({\r\n          url: $B.mergedTmpl,\r\n          type: 'GET',\r\n          async: async || false,\r\n          timeout: 7000,\r\n          dataType: 'html',\r\n          data: $B.version,\r\n          success: function(data) {\r\n            if ($B.mergedTmpl) {\r\n              $(document.body).append(data);\r\n              $B.mergedTmpl = false;\r\n            }\r\n          },\r\n          error: function() {\r\n            if ($B.mergedTmpl) {\r\n              // \"timeout\", \"error\", \"abort\", and \"parsererror\"\r\n              if (tries < 3) {\r\n                tries += 1;\r\n                getMergedTmpl();\r\n              } else {\r\n                $B.mergedTmpl = false;\r\n              }\r\n            }\r\n          }\r\n        });\r\n      }\r\n    };\r\n  }());\r\n\r\n\r\n  /**\r\n   * Ejecuta la funcion pasada como parametro asegurandose de que esta cargada la API de gmaps\r\n   * @param {function} funcion a ejecutar\r\n   */\r\n  $B.gmaps = (function() {\r\n    var stack = [];\r\n\r\n    function checkGmapsAndApplyCallback(data) {\r\n      var loadGmap = function() {\r\n          require(['async!https://maps.googleapis.com/maps/api/js?v=3.7&client=gme-bbva&sensor=false&channel=bbvanet'], function() {\r\n            require(['order!bbva.tlgo.map', 'order!libs/infobox'], function() {\r\n              if (!$B.google && _.isArray(stack)) {\r\n                $B.google = true;\r\n                $.when(\r\n                  _.each(stack, function(o) {\r\n                    o.callbackFn.apply(o.callbackContext, o.callbackArgs);\r\n                  })\r\n                ).done(function() {\r\n                  stack = null;\r\n                });\r\n              }\r\n            });\r\n          });\r\n        },\r\n\r\n        callbackContext = data.context,\r\n\r\n        callbackFn = (_.isObject(callbackContext) && _.isString(data.callback)) ? callbackContext[data.callback] : data.callback,\r\n\r\n        callbackArgs = (data.params || []),\r\n\r\n        invalidDataParameters = (function() {\r\n          return !data || (!data.callback && (!_.isFunction(data.callback) || !_.isFunction(data.context[data.callback])));\r\n        }());\r\n\r\n      if (invalidDataParameters) {\r\n        return;\r\n      }\r\n\r\n      if (!$B.google) {\r\n        stack.push({\r\n          callbackFn: callbackFn,\r\n          callbackArgs: callbackArgs,\r\n          callbackContext: callbackContext\r\n        });\r\n        loadGmap();\r\n      } else {\r\n        callbackFn.apply(callbackContext, callbackArgs);\r\n      }\r\n    }\r\n\r\n    return checkGmapsAndApplyCallback;\r\n  }());\r\n\r\n\r\n  /**\r\n   * Obtiene las dependencias adicionales (Google Maps y templates mergeadas)\r\n   * @param {Boolean} async True para instancia XHR asincrona. Default False\r\n   */\r\n  $B.getExtraDeps = function(async) {\r\n    if (!$B.extraDepsLoaded) {\r\n      $.unsubscribe('graphicTuSituacionLoaded');\r\n      $B.extraDepsLoaded = true;\r\n    }\r\n    // merged templates\r\n    $B.getMergedTmpl(async);\r\n  };\r\n\r\n  /**\r\n   * Muestra capa fija en la parte superior de la pantalla indicando que la sesion ha expirado y que debe recargar para poder operar\r\n   */\r\n  $B.showEndSessionWarning = function() {\r\n    var contenidoAviso = $($B.warningTemplate({\r\n      tittle: ($B.app.literals.alerta_sesion_expirada + ' <span role=\"link\">' + $B.app.literals.alerta_sesion_expirada_recargar + '</span>.')\r\n    }));\r\n    contenidoAviso\r\n      .attr('id', 'sesionCaducada')\r\n      .find('.textoGestionable')\r\n      .remove();\r\n\r\n    contenidoAviso.find('h1 span').on('click', function() {\r\n      $B.reloadSpi();\r\n    });\r\n\r\n    $('body').prepend(contenidoAviso);\r\n\r\n    $('.container_24').eq(0).css({\r\n      'padding-top': (contenidoAviso.outerHeight() + 'px')\r\n    });\r\n  };\r\n\r\n\r\n  (function() {\r\n    var injectElementWithStyles = function(rule, callback, nodes, testnames) {\r\n\r\n        var style,\r\n          ret,\r\n          node,\r\n          docOverflow,\r\n          mod = 'modernizr',\r\n          docElement = document.documentElement,\r\n          div = document.createElement('div'),\r\n          body = document.body,\r\n          fakeBody = body || document.createElement('body');\r\n\r\n        if (parseInt(nodes, 10)) {\r\n          while (nodes) {\r\n            node = document.createElement('div');\r\n            node.id = testnames ? testnames[nodes] : mod + (nodes + 1);\r\n            div.appendChild(node);\r\n            nodes = nodes - 1;\r\n          }\r\n        }\r\n\r\n        style = ['&#173;', '<style id=\"s', mod, '\">', rule, '</style>'].join('');\r\n        div.id = mod;\r\n        (body ? div : fakeBody).innerHTML += style;\r\n        fakeBody.appendChild(div);\r\n        if (!body) {\r\n          fakeBody.style.background = '';\r\n          fakeBody.style.overflow = 'hidden';\r\n          docOverflow = docElement.style.overflow;\r\n          docElement.style.overflow = 'hidden';\r\n          docElement.appendChild(fakeBody);\r\n        }\r\n\r\n        ret = callback(div, rule);\r\n        if (!body) {\r\n          fakeBody.parentNode.removeChild(fakeBody);\r\n          docElement.style.overflow = docOverflow;\r\n        } else {\r\n          div.parentNode.removeChild(div);\r\n        }\r\n\r\n        return !!ret;\r\n\r\n      },\r\n      getTouchCapabilities = function() {\r\n        var bool,\r\n          prefixes = [' ', '-webkit-', '-moz-', '-o-', '-ms-', ' '],\r\n          mod = 'modernizr';\r\n\r\n        if ((document.hasOwnProperty && document.hasOwnProperty('ontouchstart')) || (window.hasOwnProperty && window.hasOwnProperty('ontouchstart')) || (window.DocumentTouch && document instanceof DocumentTouch)) {\r\n          bool = true;\r\n        } else {\r\n          injectElementWithStyles(['@media (', prefixes.join('touch-enabled),('), mod, ')', '{#modernizr{top:9px;position:absolute}}'].join(''), function(node) {\r\n            bool = node.offsetTop === 9;\r\n          });\r\n        }\r\n\r\n        return bool;\r\n      },\r\n      getFlashSupport = function() {\r\n        var bool;\r\n\r\n        if ((typeof(navigator.plugins) !== 'undefined') && (typeof(navigator.plugins['Shockwave Flash']) === 'object')) {\r\n          bool = true;\r\n        } else {\r\n          bool = false;\r\n        }\r\n        return bool;\r\n      };\r\n\r\n    if ($B.appConfig.enableTabletFeatures) {\r\n      $B.capabilities.touch = getTouchCapabilities();\r\n      $B.capabilities.flash = getFlashSupport();\r\n      if ($B.capabilities.touch) {\r\n        $('body').addClass('tabletCapabilities');\r\n      }\r\n    }\r\n  }());\r\n}(window, jQuery));"],"file":"bbva.base.js"}